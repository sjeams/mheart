{"version":3,"sources":["assets\\Script\\login\\loading.js"],"names":["self","cc","Class","Component","properties","speed","progressBar","type","ProgressBar","text","Sprite","audio","AudioClip","play","audioSource","pause","bmp_font","Label","onLoad","console","log","node","_urls","resource","progress","string","_clearAll","loader","load","_progressCallback","bind","_completeCallback","start","i","length","url","release","completeCount","totalCount","res","sys_label","getChildByName","getComponent","parseInt","current","audioEngine","err","texture","loadnextScene","update","dt","active","enabled","director","preloadScene","token","sys","localStorage","getItem","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["var self = this;\r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        speed: 1,\r\n        progressBar:{\r\n            default:null,\r\n            type:cc.ProgressBar,\r\n            text:cc.Sprite,\r\n        },\r\n        audio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        play: function () {\r\n            this.audioSource.play();\r\n        },\r\n        \r\n        pause: function () {\r\n            this.audioSource.pause();\r\n        },\r\n        bmp_font: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        // //默认头像\r\n        // headpic:{\r\n        //     type:cc.SpriteFrame,\r\n        //     default:null,\r\n        // },\r\n        //头像\r\n        // background:{\r\n        //     default:null,\r\n        //     type:cc.Sprite,\r\n        // },\r\n    },\r\n\r\n        \r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n \r\n    onLoad () {\r\n        console.log(this.node);\r\n            console.log('正在对比资源');\r\n            // // 远程 url 不带图片后缀名，此时必须指定远程图片文件的类型\r\n            // remoteUrl = \"http://unknown.org/emoji?id=124982374\";\r\n            // cc.loader.load({url: remoteUrl, type: 'png'}, function () {\r\n            //     // Use texture to create sprite frame\r\n            // });\r\n            \r\n            // // 用绝对路径加载设备存储内的资源，比如相册\r\n            // var absolutePath = \"/dara/data/some/path/to/image.png\"\r\n            // cc.loader.load(absolutePath, function () {\r\n            //     // Use texture to create sprite frame\r\n            // });\r\n            console.log('正在加载场景资源，请耐心等待...');\r\n        // 加载资源包\r\n        this._urls = [\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=https://www.aheart.cn/app/loading/jianzhicangmang.mp3', type:'mp3'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=https://www.aheart.cn/app/loading/loading.jpg', type:'jpg'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/123.jpg', type:'jpg'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/ccc.png', type:'png'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/jq22honey.zip', type:'zip'},\r\n            // {url:'https://www./app/api/file-content?url=http://127.0.0.1/monster.zip', type:'zip'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1（这里填你的服务器ip)/image2.png', type:'png'}, \r\n        ];\r\n        // console.log( this.progressBar); \r\n        // console.log( this.sprite); \r\n        this.resource = null;\r\n        this.progressBar.progress =0;\r\n\r\n        this.bmp_font.string = \"0%\";\r\n        // this.ProgressBar.progress += math_random / 100; \r\n        this._clearAll();\r\n       \r\n        cc.loader.load(this._urls, this._progressCallback.bind(this), this._completeCallback.bind(this));\r\n    },\r\n \r\n    start () {\r\n\r\n    },\r\n \r\n    _clearAll: function() {\r\n        for(var i = 0; i < this._urls.length; ++i) {\r\n            var url = this._urls[i];\r\n            cc.loader.release(url);\r\n        }\r\n    },\r\n \r\n    _progressCallback: function(completeCount, totalCount, res) {\r\n        //加载进度回调\r\n        // console.log('资源 ' + completeCount + '加载完成！资源加载中...');\r\n        // console.log('加载场景资源');\r\n        this.progressBar.progress = completeCount / totalCount;\r\n        this.progressBar.completeCount = completeCount;\r\n        this.progressBar.totalCount = totalCount;\r\n        this.resource = res;\r\n        // 代码里面获取cc.Label组件, 修改文本内容\r\n        //在代码里面获取cc.Label组件\r\n        var sys_label = this.node.getChildByName(\"sys_label\").getComponent(cc.Label);\r\n        sys_label.string = parseInt(this.progress * 100) + '%';\r\n\r\n        if( this.resource.type=='json'){\r\n            // console.log(this.resource);  // json\r\n            // 从服务器加载mp3来进行播放\r\n            // this.audio.clip = ret;\r\n            // this.audio.play();\r\n        }\r\n        if( this.resource.type=='png'||this.resource.type=='jpg'){\r\n             console.log(res);  // json\r\n            //res是cc.Texture2D这样对象 \r\n            //   this.node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(res)\r\n            // this.headpic.spriteFrame.setTexture(res);\r\n            // this.node.spriteFrame.setTexture(res);\r\n            // this.sprite.spriteFrame.setContentSize(res.getContentSize());\r\n            // this.node.getComponent(cc.Sprite).spriteFrame = res;\r\n        }\r\n        if( this.resource.type=='mp3'){\r\n            console.log(res);  // mp3\r\n            // this.audio.clip = res;\r\n            // this.audio.play();\r\n            // 从服务器加载mp3来进行播放\r\n            this.current = cc.audioEngine.play(res.url, false, 1);\r\n        }\r\n\r\n\r\n    },\r\n \r\n    _completeCallback: function(err, texture) {\r\n        //加载完成回调\r\n        this.loadnextScene();  // 下一场景 \r\n    },\r\n \r\n    update (dt) {\r\n        if(!this.resource){\r\n            return ;\r\n        }\r\n        var progress = this.progressBar.progress;\r\n        if(progress >= 1){\r\n            console.log('加载完成')\r\n            //加载完成\r\n            this.progressBar.node.active = false; //进度条隐藏\r\n            this.bmp_font.node.active = false;  // 进度隐藏\r\n            this.enabled = false;\r\n            return ;\r\n        }\r\n \r\n        if(progress < this.progress){\r\n            progress += dt;\r\n        }\r\n   \r\n        this.progressBar.progress = progress;\r\n   \r\n    },\r\n\r\n    loadnextScene: function() {\r\n        // 登录预加载\r\n        cc.director.preloadScene('index', function () {\r\n            cc.log('登录预加载');\r\n            // // 请求登录接口\r\n            // var params = {\r\n            //         'loginname': 'yincan1993',\r\n            //         'password': 123456,\r\n            //         'serverid': 1,\r\n            // };\r\n        });\r\n        var token = cc.sys.localStorage.getItem(\"token\")\r\n        if(token){\r\n            cc.log('快速登录');\r\n            cc.log(token);\r\n            cc.director.loadScene('index');\r\n            // cc.sys.localStorage.setItem('params', JSON.stringify(params)); \r\n        }else{\r\n            cc.log('账号注册/登录');\r\n            cc.director.loadScene('index');\r\n            // cc.sys.localStorage.setItem('params', JSON.stringify(params));\r\n        }\r\n  \r\n    },\r\n\r\n// 　　 changeBj: function(){\r\n// 　　　　var url = 'globalUI/video/gVideoPlayClick';\r\n// 　　　　var _this = this; cc.loader.loadRes(url,cc.SpriteFrame,function(err,spriteFrame)\r\n// 　　　　{ 　\r\n// 　　　　　　_this.isPlay.spriteFrame = spriteFrame;\r\n// 　　　　 });\r\n    \r\n// 　　　\r\n// 　　　　//加载网络图片\r\n//         var url = \"www.monster.com/web/app/loading.jpg\";\r\n//         cc.loader.load({url: url, type: 'png'}, function(err,img){\r\n//             var mylogo  = new cc.SpriteFrame(img); \r\n//             self.logo.spriteFrame = mylogo;\r\n//         });\r\n// 　　　},\r\n});\r\n\r\n\r\n"]}
{"version":3,"sources":["assets\\Script\\progressTools.js"],"names":["HttpHelper","require","cc","Class","Component","properties","speed","progressBar","ProgressBar","audio","type","AudioClip","play","audioSource","pause","sys_label","Label","onLoad","resource","progress","string","_clearAll","start","i","_urls","length","url","loader","release","_progressCallback","completeCount","totalCount","res","node","getChildByName","getComponent","parseInt","current","audioEngine","update","dt","console","log","active","bmp_font","enabled","_completeCallback","err","texture","loadnextScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["var HttpHelper = require(\"http\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        speed: 1,\r\n        progressBar:cc.ProgressBar,\r\n        audio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        play: function () {\r\n            this.audioSource.play();\r\n        },\r\n        \r\n        pause: function () {\r\n            this.audioSource.pause();\r\n        },\r\n        sys_label:cc.Label,\r\n \r\n    },\r\n    onLoad () {\r\n        // 加载资源包\r\n        // this._urls = [\r\n            // {url:''}\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=https://www.aheart.cn/app_resources/loading/jianzhicangmang.mp3', type:'mp3'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=https://www.aheart.cn/app/loading/loading.jpg', type:'jpg'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/123.jpg', type:'jpg'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/ccc.png', type:'png'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1/jq22honey.zip', type:'zip'},\r\n            // {url:'https://www./app/api/file-content?url=http://127.0.0.1/monster.zip', type:'zip'},\r\n            // {url:'https://www.aheart.cn/app/api/file-content?url=http://127.0.0.1（这里填你的服务器ip)/image2.png', type:'png'},\r\n        // ];\r\n        // this._urls =[];\r\n        // console.log( this.progressBar); \r\n        // console.log( this.sprite); \r\n        this.resource = null;\r\n        this.progressBar.progress =0;\r\n        this.sys_label.string = \"0%\";\r\n        // this.ProgressBar.progress += math_random / 100; \r\n        this._clearAll();\r\n        // cc.loader.load(this._urls, this._progressCallback.bind(this), this._completeCallback.bind(this));\r\n    },\r\n \r\n\r\n    \r\n    start () {\r\n\r\n    },\r\n    _clearAll: function() {\r\n        // console.log(this._urls.length)\r\n        for(var i = 0; i <= this._urls.length; ++i) {\r\n            var url = this._urls[i];\r\n            cc.loader.release(url);\r\n        }\r\n    },\r\n    _progressCallback: function(completeCount, totalCount, res) {\r\n        //加载进度回调\r\n        // console.log('资源 ' + completeCount + '加载完成！资源加载中...');\r\n        // console.log('加载场景资源');\r\n        this.progressBar.progress = completeCount / totalCount;\r\n        this.progressBar.completeCount = completeCount;\r\n        this.progressBar.totalCount = totalCount;\r\n        this.resource = res;\r\n        // 代码里面获取cc.Label组件, 修改文本内容\r\n        //在代码里面获取cc.Label组件\r\n        var sys_label = this.node.getChildByName(\"sys_label\").getComponent(cc.Label);\r\n        sys_label.string = parseInt(this.progress * 100) + '%';\r\n        if( this.resource.type=='mp3'){\r\n            // console.log(res);  // mp3\r\n            // this.audio.clip = res;\r\n            // this.audio.play();\r\n            // 从服务器加载mp3来进行播放\r\n            this.current = cc.audioEngine.play(res.url, false, 1);\r\n        }\r\n    },\r\n    update (dt) {\r\n        if(!this.resource){\r\n            return ;\r\n        }\r\n        var progress = this.progressBar.progress;\r\n        if(progress >= 1){\r\n            console.log('加载完成')\r\n            //加载完成\r\n            this.progressBar.node.active = false; //进度条隐藏\r\n            this.bmp_font.node.active = false;  // 进度隐藏\r\n            this.enabled = false;\r\n            return ;\r\n        }\r\n        if(progress < this.progress){\r\n            progress += dt;\r\n        }\r\n        this.progressBar.progress = progress;\r\n    },\r\n    _completeCallback: function(err, texture) {\r\n        //加载完成回调\r\n        this.loadnextScene();  // 下一场景 \r\n    },\r\n    loadnextScene: function() {\r\n        // 登录预加载\r\n        // cc.director.preloadScene('index', function () {\r\n        //     cc.log('登录预加载');\r\n        //     // // 请求登录接口\r\n        //     // var params = {\r\n        //     //         'loginname': 'yincan1993',\r\n        //     //         'password': 123456,\r\n        //     //         'serverid': 1,\r\n        //     // };\r\n        // });\r\n        // var params = cc.sys.localStorage.getItem(\"params\")\r\n        // if(params){\r\n        //     cc.log('快速登录');\r\n        //     cc.log(params);\r\n        //     cc.director.loadScene('index');\r\n        //     // cc.sys.localStorage.setItem('params', JSON.stringify(params)); \r\n        // }else{\r\n        //     cc.log('账号注册/登录');\r\n        //     cc.director.loadScene('index');\r\n        //     // cc.sys.localStorage.setItem('params', JSON.stringify(params));\r\n        // }\r\n    },\r\n\r\n// 　　 changeBj: function(){\r\n// 　　　　var url = 'globalUI/video/gVideoPlayClick';\r\n// 　　　　var _this = this; cc.loader.loadRes(url,cc.SpriteFrame,function(err,spriteFrame)\r\n// 　　　　{ 　\r\n// 　　　　　　_this.isPlay.spriteFrame = spriteFrame;\r\n// 　　　　 });\r\n    \r\n// 　　　\r\n// 　　　　//加载网络图片\r\n//         var url = \"www.monster.com/web/app/loading.jpg\";\r\n//         cc.loader.load({url: url, type: 'png'}, function(err,img){\r\n//             var mylogo  = new cc.SpriteFrame(img); \r\n//             self.logo.spriteFrame = mylogo;\r\n//         });\r\n// 　　　},\r\n});"]}
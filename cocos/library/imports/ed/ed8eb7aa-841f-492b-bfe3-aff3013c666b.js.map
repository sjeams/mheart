{"version":3,"sources":["assets\\Script\\战斗\\home_fighting.js"],"names":["cc","Class","Component","properties","toolsArray","fightingArray","home","Node","back_time","init","onLoad","http_globalData","BoxPrefab_content","find","sys","httpRequestModel","model_back_button","httpRequestBagApi","http_music","http_user_info","http_base_model","spawnTools","fightingEnd","playTask","goPlay","httpRequestFightingExtend","alertBoat","fighting_boat","start","update","dt","Promise","resolve","getComponent","Label","string","user_info","beishu","figthing_remote_url","localStorage","getItem","httpRequest","playGame","remoteUrl","httpUrlJson","loader","load","url","err","data","fighting","unscheduleAllCallbacks","biolgy_state","poition_my","poition_enemy","BoxPrefab","biology_detail_list","length","TipBoxPrefab_model","info_list","is_my","star","_this","TOOLS","prop","TipBoxPrefab_icon","instantiate","http_globalAsset","model_biology_fightingBiology","map","info","biology","map_value","map_x","x","getChildByName","Sprite","spriteFrame","http_base_asset_biology","picture","setScale","color","number_string_wan","shengMing","moFa","name","grade","state","model_biology_fightingBiology_button","parseInt","y","jing_bi","jingBi","biology_int","id","biology_name","push","addChild","fighting_list","boat_length","fighting_history","history_count","boat","boat_count","bpage","total","fighting_historyWait","fighting_historyGo","fighting_historyDo","alertResult","onButtonClicked","event","active","his_log","h_yubei","readySkill","h_go","playSkill","h_need","needSkill","h_do","h_putong","playFight","addMapPic","map_pic","httpUrl","texture","SpriteFrame","his_log_extend","npage","_this_hero_node","goid","_targ_hero_node","doid","buttonReady","buttonSkill","playAction","buttonMove","bagBtn","gridLayout","parent","forEach","element","removeFromParent","hp_update","node","hp","fill","all_hp","hp_now","fillstart","act_shan","sequence","fadeTo","runAction","repeat","back_reload","removeBoxprefab","back_home","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","button_beishu","http_user_beishu_update","back_time_show"],"mappings":"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","sourceRoot":"/","sourcesContent":["// require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n      // 根据TOOLS生成相应的道具\r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      home: cc.Node,\r\n      back_time: cc.Node, //跳过回合\r\n    },\r\n    init(){\r\n      // cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    async onLoad () {\r\n      //全局定义容器节点\r\n      http_globalData.BoxPrefab_content= cc.find('Canvas/大厅/content');\r\n      cc.sys.fightingArray=[]\r\n      cc.sys.toolsArray=[]\r\n      await httpRequestModel.model_back_button('sence_ditu')//返回按钮\r\n      await httpRequestBagApi.http_music()\r\n      await httpRequestBagApi.http_user_info() //加载用户信息\r\n      await httpRequestModel.http_base_model();  // 引入 战斗模型model\r\n      // this.spawnTools()\r\n      await this.spawnTools() //加载数据\r\n      await httpRequestModel.fightingEnd() //加载结果\r\n      await this.playTask() //开启回合战斗\r\n    },\r\n    //task\r\n    async playTask(){\r\n      await this.goPlay() //实例化对象\r\n      await httpRequestFightingExtend.alertBoat('准备回合') //准备回合\r\n      await this.fighting_boat() //开启回合战斗\r\n\t  },\r\n\r\n\r\n    start () {\r\n    },\r\n    update (dt) {\r\n      // console.log(3333)\r\n    },\r\n    async spawnTools () {\r\n      return new Promise(resolve => {\r\n      //开启倍数\r\n      cc.find('Canvas/倍数/倍数s').getComponent(cc.Label).string = http_globalData.user_info.beishu;\r\n      // var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n          httpRequest.playGame(\"sence_ditu\")\r\n          resolve(); \r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n          //定义常量\r\n          http_globalData.fighting = data;\r\n          //开启战斗\r\n          resolve(); \r\n        });    \r\n      }\r\n      })\r\n    },\r\n\r\n\r\n    //开启战斗--加载生物\r\n    async goPlay( ){\r\n      // return new Promise(resolve => {\r\n        //播放器先清除所有定时器\r\n        this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n        let data = http_globalData.fighting\r\n        // cc.log(data)\r\n        var biolgy_state = data.data.biolgy_state;\r\n        var poition_my = data.data.poition_my;\r\n        var poition_enemy = data.data.poition_enemy;\r\n        //生物挂载\r\n        var BoxPrefab = http_globalData.BoxPrefab_content\r\n        await this.biology_detail_list(BoxPrefab,poition_my,biolgy_state,1,0) //挂载生物--position_my\r\n        await this.biology_detail_list(BoxPrefab,poition_enemy,biolgy_state,0,poition_my.length) //挂载生物--position_ememy\r\n    },\r\n    //生成生物\r\n    async biology_detail_list(TipBoxPrefab_model,info_list,biolgy_state,is_my,star){\r\n        return new Promise(resolve => {\r\n          var _this =this;\r\n          var TOOLS =[];\r\n          var TOOLS = info_list;\r\n          for (var prop in info_list) {\r\n              //声明节点对象\r\n              let  TipBoxPrefab_icon =  cc.instantiate(http_globalAsset.model_biology_fightingBiology);\r\n              let map = TOOLS[prop];\r\n              let info = map.biology;\r\n              //设置距离\r\n              var map_value = 50\r\n              if(is_my){\r\n                  var map_x =    map.x-map_value\r\n              }else{\r\n                  var map_x =    map.x+map_value\r\n              }\r\n              if(info.length!=0){\r\n                  //放在资源下面\r\n                  //加载图片\r\n                  TipBoxPrefab_icon.getChildByName('生物').getComponent(cc.Sprite).spriteFrame = http_globalAsset.http_base_asset_biology[info.picture]\r\n                  if(is_my==0){\r\n                      //图片翻转\r\n                      TipBoxPrefab_icon.getChildByName('生物').setScale(-1, 1);\r\n                  }\r\n                  TipBoxPrefab_icon.getChildByName('生物').color = new cc.color(info.color); \r\n                  TipBoxPrefab_icon.getChildByName('生命s').getComponent(cc.Label).string= httpRequest.number_string_wan(info.shengMing,2);\r\n                  TipBoxPrefab_icon.getChildByName('魔法s').getComponent(cc.Label).string= httpRequest.number_string_wan(info.moFa,2);\r\n                  TipBoxPrefab_icon.getChildByName('生物名称s').getComponent(cc.Label).string= info.name\r\n                  TipBoxPrefab_icon.getChildByName('生物等级s').getComponent(cc.Label).string= '等级'+info.grade+'('+biolgy_state[info.state]+')';\r\n                  //创建一个新button 并将其挂载到创建的精灵下\r\n                  httpRequestModel.model_biology_fightingBiology_button(TipBoxPrefab_icon,info);\r\n                  //写入icon\r\n                  TipBoxPrefab_icon.x=parseInt(map_x) //重新定义了间距\r\n                  TipBoxPrefab_icon.getChildByName('阵法s').getComponent(cc.Label).string= parseInt(prop)+1;\r\n                  TipBoxPrefab_icon.y=map.y\r\n                  TipBoxPrefab_icon.is_my=is_my//阵容\r\n                  TipBoxPrefab_icon.jing_bi=map.biology.jingBi//金币\r\n                  TipBoxPrefab_icon.biology_int=  parseInt(prop)+1//阵法编号\r\n                  TipBoxPrefab_icon.shengMing=map.biology.shengMing\r\n                  TipBoxPrefab_icon.moFa=map.biology.moFa\r\n                  TipBoxPrefab_icon.biology=map.biology.id\r\n                  TipBoxPrefab_icon.biology_name=map.biology.name\r\n                  cc.sys.toolsArray.push(TipBoxPrefab_icon);\r\n                  cc.sys.fightingArray[map.biology.id]=TipBoxPrefab_icon;\r\n                  TipBoxPrefab_model.addChild(TipBoxPrefab_icon);\r\n              }\r\n          }\r\n        resolve();\r\n        })\r\n    },\r\n    // 战斗回合\r\n    async fighting_boat(){\r\n      var _this =this;\r\n      // return new Promise(resolve => {\r\n      var fighting_list =  http_globalData.fighting.data;    \r\n      var boat_length = fighting_list.fighting_history.length\r\n      var history_count =  fighting_list.history_count\r\n      var fighting_history= fighting_list.fighting_history;\r\n      if(boat_length!=0){\r\n        var boat=0;\r\n        var boat_count=-1;\r\n        //一条或多条执行语句\r\n        // _this.schedule(function(){\r\n        //循环历史行动条数\r\n        for (var bpage=0; bpage<boat_length; bpage++){\r\n        // _this.schedule(function(){\r\n            boat_count++\r\n            if(history_count[boat].total<boat_count){\r\n              boat++;\r\n            }\r\n            await httpRequestFightingExtend.alertBoat('第'+ parseInt(boat+1)+'回合')\r\n            //如果是空回合 ，等待跳过\r\n            if(fighting_history[boat_count]){\r\n              // cc.log(fighting_history[boat_count])\r\n              await   _this.fighting_historyWait(fighting_history[boat_count])//执行战斗等待回合\r\n              await   _this.fighting_historyGo(fighting_history[boat_count])//执行被动\r\n              await   _this.fighting_historyDo(fighting_history[boat_count])//执行技能 \r\n              await   _this.fighting_history(fighting_history[boat_count])//普通   \r\n            }     \r\n        // },1,boat_length,1.5);////2秒后执行1次间隔5秒\r\n          }\r\n      }\r\n      return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // resolve();})\r\n    },\r\n \r\n    //暂停并且跳过回合\r\n    onButtonClicked: function(event) {\r\n      // return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // 跳过回合\r\n      // var _this =this\r\n      // _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n      //   cc.log('跳过')\r\n    },\r\n\r\n    alertResult(){\r\n      var _this =this;\r\n      cc.find('Canvas/结算').active =true;// 结束弹窗结果\r\n      // _this.unschedule();\r\n      _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n    },\r\n    //预备回合\r\n    async fighting_historyWait(his_log){\r\n      var _this = this;\r\n        if(his_log.h_yubei.length!=0){\r\n          await  _this.readySkill(his_log.h_yubei)\r\n          // cc.log('预备回合')\r\n        }\r\n    },\r\n    //发起被动\r\n    async fighting_historyGo(his_log) {\r\n       var _this =this;\r\n        if(his_log.h_go.length!=0){\r\n            //消耗魔法 --技能名称和消耗放一起了\r\n            await   _this.playSkill(his_log.h_go)\r\n            if(his_log.h_need.length!=0){\r\n              await  _this.needSkill(his_log.h_need)\r\n            }\r\n\r\n        }\r\n    },\r\n    //发起技能\r\n    async fighting_historyDo (his_log) {\r\n      var _this =this;\r\n          if(his_log.h_do.length!=0){\r\n              //消耗魔法 --技能名称和消耗放一起了\r\n              await   _this.playSkill(his_log.h_do)\r\n              if(his_log.h_need.length!=0){\r\n                await  _this.needSkill(his_log.h_need)\r\n              }\r\n    \r\n          }\r\n      },\r\n    //战斗回合\r\n    async fighting_history(his_log) {\r\n      // return new Promise(resolve => {\r\n        var _this = this;\r\n        //回合结束\r\n        // if(his_log.h_end.length!=0){\r\n        //   cc.log('回合结束')\r\n        // }\r\n        // cc.log(his_log)\r\n\r\n        //反击\r\n        // if(his_log.h_back.length!=0){\r\n        //   _this.playFight(_this_hero_node,_targ_hero_node,biology,his_log.h_back)\r\n        // }\r\n        //普通攻击\r\n        if(his_log.h_putong.length!=0){\r\n          await     _this.playFight(his_log.h_putong)\r\n        }\r\n    },\r\n\r\n\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n \r\n    //技能准备动作\r\n    async  readySkill(his_log_extend){\r\n      // return new Promise(resolve => {\r\n        if(his_log_extend.length!=0){\r\n          var _this =this\r\n          for (var npage=0; npage<his_log_extend.length; npage++){\r\n            var biology = his_log_extend[npage];\r\n            var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n            var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,1)\r\n            }\r\n        } \r\n      // resolve();})\r\n    },\r\n    //技能消耗动作\r\n    async needSkill(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          // _this.buttonShake(0.5,_targ_hero_node,biology)//技能攻击\r\n          // _this.schedule(function(){\r\n            await httpRequestFightingExtend.buttonSkill(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n          // },1)\r\n        }\r\n      }\r\n    },\r\n    //技能攻击动作\r\n    async playSkill(his_log_extend){\r\n     \r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          \r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          //2个攻击类型只能二选一 \r\n          // _this.buttonShake(0.1,_targ_hero_node,biology)//技能攻击，动作后伤害\r\n          await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n  \r\n        }\r\n      }\r\n \r\n    },\r\n    //普通攻击动作\r\n    async  playFight(his_log_extend){\r\n      // return new Promise(resolve => {\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(cc.sys.fightingArray)\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          if(biology.goid==biology.doid){\r\n              // _this.buttonShake(0,_targ_hero_node,biology)//自己闪动\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,0)\r\n          }else{\r\n            await httpRequestFightingExtend.buttonMove(_this_hero_node,_targ_hero_node,biology,0) //移动\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,0)\r\n          }\r\n        }\r\n      }\r\n    // resolve();})\r\n    },\r\n\r\n    //生物渐隐-淡出-淡入\r\n    // nodefadeIn(time,type,node){\r\n    //   // cc.log(node)\r\n    //   var fin_arr=[];\r\n    //   if(type==0){\r\n    //     //先让透明度为0\r\n    //     node.getChildByName('扣血s').opacity=0\r\n    //     fin_arr.push(cc.fadeIn(time));\r\n    //   }else{\r\n    //     //先让透明度为255\r\n    //     node.getChildByName('扣血s').opacity=255\r\n    //     fin_arr.push(cc.fadeOut(time));\r\n    //   }\r\n    //   fin_arr.push(cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n    //     node.getChildByName('扣血s').active=false\r\n    //   },this)) )\r\n    //   node.getChildByName('扣血s').runAction(fin_arr);\r\n    // },\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          // this.toolsArray.forEach(element => {\r\n          //     element.removeFromParent();\r\n          // });\r\n          cc.sys.toolsArray.forEach(element => {\r\n                element.removeFromParent();\r\n            });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    // reloadWord(){\r\n    //   var _this =this;\r\n    //   httpRequest.httpPost('/app/app-apiword/map-word',{}, function (data) {\r\n    //     //写入地图数据\r\n    //     _this.addWordMap(data)\r\n    //     })\r\n    // },\r\n    // back_map(){\r\n    //   //移除节点\r\n    //   // var _this = this;\r\n    //   // httpRequestModel.removeBoxprefab()\r\n    //   httpRequest.playGame(\"sence_ditu\")\r\n    // },\r\n    //重播\r\n    back_reload(){\r\n      //移除节点\r\n      var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      _this.playTask( )\r\n      cc.find('Canvas/结算').active =false;// 结束弹窗结果\r\n    },\r\n    back_home(){\r\n      //移除节点\r\n      // var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      httpRequest.playGame(\"sence_dating\")\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n \r\n    // onDestroy() {\r\n    //     // 停止定时器\r\n    //     this.unschedule(this.fighting_history);\r\n    // }\r\n    async button_beishu(){\r\n      // var beisu_arr =[1,2,3,4,8];\r\n      if(http_globalData.user_info.beishu<4){\r\n        http_globalData.user_info.beishu = parseInt(http_globalData.user_info.beishu)+1\r\n      }else{\r\n        http_globalData.user_info.beishu=1\r\n      }\r\n      //修改倍数\r\n      await httpRequestBagApi.http_user_beishu_update()\r\n      // http_globalData.user_info.beishu\r\n      cc.find('Canvas/倍数/倍数s').getComponent(cc.Label).string = http_globalData.user_info.beishu;\r\n    },\r\n    // back_home(){\r\n    //   httpRequest.playGame(\"sence_dating\")\r\n    // },\r\n    //跳过回合\r\n    back_time_show(){ \r\n      // this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n      cc.find('Canvas/结算').active =true;\r\n    },\r\n \r\n});\r\n"]}
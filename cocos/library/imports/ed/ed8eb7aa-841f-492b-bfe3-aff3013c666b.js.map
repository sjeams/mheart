{"version":3,"sources":["assets\\Script\\战斗\\score_fighting.js"],"names":["cc","Class","Component","properties","toolsArray","fightingArray","home","Node","back_time","init","onLoad","http_globalData","BoxPrefab_content","find","sys","httpRequestBagApi","http_music","httpRequestModel","http_base_model","http_user_info","spawnTools","fightingEnd","playTask","goPlay","httpRequestFightingExtend","alertBoat","fighting_boat","start","update","dt","Promise","resolve","getComponent","Label","string","user_info","beishu","figthing_remote_url","localStorage","getItem","httpRequest","playGame","remoteUrl","httpUrlJson","loader","load","url","err","data","fighting","unscheduleAllCallbacks","biolgy_state","poition_my","poition_enemy","BoxPrefab","biology_detail_list","length","_this","fighting_list","boat_length","fighting_history","history_count","boat","boat_count","bpage","total","parseInt","fighting_historyWait","fighting_historyGo","fighting_historyDo","alertResult","onButtonClicked","event","active","his_log","h_yubei","readySkill","h_go","playSkill","h_need","needSkill","h_do","h_putong","playFight","addMapPic","map_pic","httpUrl","texture","Sprite","spriteFrame","SpriteFrame","his_log_extend","npage","biology","_this_hero_node","goid","_targ_hero_node","doid","buttonReady","buttonSkill","playAction","buttonMove","bagBtn","gridLayout","parent","forEach","element","removeFromParent","hp_update","node","hp","fill","all_hp","hp_now","fillstart","act_shan","sequence","fadeTo","runAction","repeat","back_map","removeBoxprefab","back_reload","back_home","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd"],"mappings":"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","sourceRoot":"/","sourcesContent":["// require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n      // 根据TOOLS生成相应的道具\r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      // content: cc.Node,\r\n      // person: cc.Prefab,\r\n      home: cc.Node,\r\n      // back: cc.Node,\r\n      back_time: cc.Node, //跳过回合\r\n      // //列表\r\n      // test_scrollView: {\r\n      //   default: null,\r\n      //   type: cc.ScrollView\r\n      // },\r\n      // //翻页容器\r\n      // test_pageView: {\r\n      //   default: null,\r\n      //   type: cc.PageView\r\n      // },\r\n\r\n    },\r\n    init(){\r\n      // cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    async onLoad () {\r\n      //全局定义容器节点\r\n      http_globalData.BoxPrefab_content= cc.find('Canvas/大厅/content');\r\n      cc.sys.fightingArray=[]\r\n      cc.sys.toolsArray=[]\r\n      await httpRequestBagApi.http_music()\r\n\r\n      await httpRequestModel.http_base_model();  // 引入 战斗模型model\r\n      // this.spawnTools()\r\n      await httpRequestBagApi.http_user_info() //加载用户信息\r\n      await this.spawnTools() //加载数据\r\n      await httpRequestModel.fightingEnd() //加载结果\r\n      await this.playTask() //开启回合战斗\r\n    },\r\n    //task\r\n    async playTask(){\r\n      await this.goPlay() //实例化对象\r\n      await httpRequestFightingExtend.alertBoat('准备回合') //准备回合\r\n      await this.fighting_boat() //开启回合战斗\r\n\t  },\r\n\r\n\r\n    start () {\r\n    },\r\n    update (dt) {\r\n      // console.log(3333)\r\n    },\r\n    async spawnTools () {\r\n      return new Promise(resolve => {\r\n      //开启倍数\r\n      cc.find('Canvas/倍数/倍数s').getComponent(cc.Label).string = http_globalData.user_info.beishu;\r\n      // var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n          httpRequest.playGame(\"sence_ditu\")\r\n          resolve(); \r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n          //定义常量\r\n          http_globalData.fighting = data;\r\n          //开启战斗\r\n          resolve(); \r\n          //  await   _this.goPlay( )\r\n        });    \r\n      }\r\n      })\r\n    },\r\n\r\n\r\n    //开启战斗--加载生物\r\n    async goPlay( ){\r\n      // return new Promise(resolve => {\r\n        //播放器先清除所有定时器\r\n        this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n        let data = http_globalData.fighting\r\n        // cc.log(data)\r\n        var biolgy_state = data.data.biolgy_state;\r\n        var poition_my = data.data.poition_my;\r\n        var poition_enemy = data.data.poition_enemy;\r\n        //生物挂载\r\n        var BoxPrefab = http_globalData.BoxPrefab_content\r\n        await BoxPrefab.getComponent('fightingTools').biology_detail_list(BoxPrefab,poition_my,biolgy_state,1,0) //挂载生物--position_my\r\n        await BoxPrefab.getComponent('fightingTools').biology_detail_list(BoxPrefab,poition_enemy,biolgy_state,0,poition_my.length) //挂载生物--position_ememy\r\n\r\n        // await this.biology_detail_list(BoxPrefab,poition_my,biolgy_state,1,0) //挂载生物--position_my\r\n        // await this.biology_detail_list(BoxPrefab,poition_enemy,biolgy_state,0,poition_my.length) //挂载生物--position_ememy\r\n      // _this.addMapPic(data) //生成地图\r\n      // console.log( _this.toolsArray)\r\n      // console.log( cc.sys.fightingArray )\r\n        // resolve();})\r\n    },\r\n    // 战斗回合\r\n    async fighting_boat(){\r\n      var _this =this;\r\n      // return new Promise(resolve => {\r\n      var fighting_list =  http_globalData.fighting.data;    \r\n      var boat_length = fighting_list.fighting_history.length\r\n      var history_count =  fighting_list.history_count\r\n      var fighting_history= fighting_list.fighting_history;\r\n      if(boat_length!=0){\r\n        var boat=0;\r\n        var boat_count=-1;\r\n        //一条或多条执行语句\r\n        // _this.schedule(function(){\r\n        //循环历史行动条数\r\n        for (var bpage=0; bpage<boat_length; bpage++){\r\n        // _this.schedule(function(){\r\n            boat_count++\r\n            if(history_count[boat].total<boat_count){\r\n              boat++;\r\n            }\r\n            await httpRequestFightingExtend.alertBoat('第'+ parseInt(boat+1)+'回合')\r\n            //判断下动作是否已经下一回合\r\n            // if(cc.find('Canvas/大厅/time').getComponent(cc.Label).string!='第'+ parseInt(boat+1)+'回合' ){\r\n            //   await this.alertBoat('第'+ parseInt(boat+1)+'回合')\r\n            //   // cc.find('Canvas/大厅/time').getComponent(cc.Label).string = '第'+ parseInt(boat+1)+'回合'                    \r\n            //   // return new Promise(resolve => {  cc.find('Canvas/大厅/time').runAction(   cc.sequence(cc.scaleTo(0.2, 2, 2),cc.scaleTo(0.2, 1,1),cc.callFunc(function(){   resolve()},this)));//建一个缩放到1.5倍大小的动作，持续时间2秒\r\n            //   //  }) \r\n            // }\r\n            // cc.log(fighting_history[boat_count])\r\n            //如果是空回合 ，等待跳过\r\n            if(fighting_history[boat_count]){\r\n              // cc.log(fighting_history[boat_count])\r\n              await   _this.fighting_historyWait(fighting_history[boat_count])//执行战斗等待回合\r\n              await   _this.fighting_historyGo(fighting_history[boat_count])//执行被动\r\n              await   _this.fighting_historyDo(fighting_history[boat_count])//执行技能 \r\n              await   _this.fighting_history(fighting_history[boat_count])//普通   \r\n            } \r\n              // 绑定点击事件\r\n              // _this.back_time.on('click', _this.onButtonClicked,this);    \r\n             \r\n        // },1,boat_length,1.5);////2秒后执行1次间隔5秒\r\n          }\r\n      }\r\n      return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // resolve();})\r\n    },\r\n \r\n    //暂停并且跳过回合\r\n    onButtonClicked: function(event) {\r\n      // return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // 跳过回合\r\n      // var _this =this\r\n      // _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n      //   cc.log('跳过')\r\n    },\r\n\r\n    alertResult(){\r\n      var _this =this;\r\n      cc.find('Canvas/结算').active =true;// 结束弹窗结果\r\n      // _this.unschedule();\r\n      _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n    },\r\n    //预备回合\r\n    async fighting_historyWait(his_log){\r\n      var _this = this;\r\n        if(his_log.h_yubei.length!=0){\r\n          await  _this.readySkill(his_log.h_yubei)\r\n          // cc.log('预备回合')\r\n        }\r\n    },\r\n    //发起被动\r\n    async fighting_historyGo(his_log) {\r\n       var _this =this;\r\n        if(his_log.h_go.length!=0){\r\n            //消耗魔法 --技能名称和消耗放一起了\r\n            await   _this.playSkill(his_log.h_go)\r\n            if(his_log.h_need.length!=0){\r\n              await  _this.needSkill(his_log.h_need)\r\n            }\r\n\r\n        }\r\n    },\r\n    //发起技能\r\n    async fighting_historyDo (his_log) {\r\n      var _this =this;\r\n          if(his_log.h_do.length!=0){\r\n              //消耗魔法 --技能名称和消耗放一起了\r\n              await   _this.playSkill(his_log.h_do)\r\n              if(his_log.h_need.length!=0){\r\n                await  _this.needSkill(his_log.h_need)\r\n              }\r\n    \r\n          }\r\n      },\r\n    //战斗回合\r\n    async fighting_history(his_log) {\r\n      // return new Promise(resolve => {\r\n        var _this = this;\r\n        //回合结束\r\n        // if(his_log.h_end.length!=0){\r\n        //   cc.log('回合结束')\r\n        // }\r\n        // cc.log(his_log)\r\n\r\n        //反击\r\n        // if(his_log.h_back.length!=0){\r\n        //   _this.playFight(_this_hero_node,_targ_hero_node,biology,his_log.h_back)\r\n        // }\r\n        //普通攻击\r\n        if(his_log.h_putong.length!=0){\r\n          await     _this.playFight(his_log.h_putong)\r\n        }\r\n    },\r\n\r\n\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n \r\n    //技能准备动作\r\n    async  readySkill(his_log_extend){\r\n      // return new Promise(resolve => {\r\n        if(his_log_extend.length!=0){\r\n          var _this =this\r\n          for (var npage=0; npage<his_log_extend.length; npage++){\r\n            var biology = his_log_extend[npage];\r\n            var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n            var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,1)\r\n            }\r\n        } \r\n      // resolve();})\r\n    },\r\n    //技能消耗动作\r\n    async needSkill(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          // _this.buttonShake(0.5,_targ_hero_node,biology)//技能攻击\r\n          // _this.schedule(function(){\r\n            await httpRequestFightingExtend.buttonSkill(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n          // },1)\r\n        }\r\n      }\r\n    },\r\n    //技能攻击动作\r\n    async playSkill(his_log_extend){\r\n     \r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          \r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          //2个攻击类型只能二选一 \r\n          // _this.buttonShake(0.1,_targ_hero_node,biology)//技能攻击，动作后伤害\r\n          await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n  \r\n        }\r\n      }\r\n \r\n    },\r\n    //普通攻击动作\r\n    async  playFight(his_log_extend){\r\n      // return new Promise(resolve => {\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(cc.sys.fightingArray)\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          if(biology.goid==biology.doid){\r\n              // _this.buttonShake(0,_targ_hero_node,biology)//自己闪动\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,0)\r\n          }else{\r\n            await httpRequestFightingExtend.buttonMove(_this_hero_node,_targ_hero_node,biology,0) //移动\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,0)\r\n          }\r\n        }\r\n      }\r\n    // resolve();})\r\n    },\r\n\r\n    //生物渐隐-淡出-淡入\r\n    // nodefadeIn(time,type,node){\r\n    //   // cc.log(node)\r\n    //   var fin_arr=[];\r\n    //   if(type==0){\r\n    //     //先让透明度为0\r\n    //     node.getChildByName('扣血s').opacity=0\r\n    //     fin_arr.push(cc.fadeIn(time));\r\n    //   }else{\r\n    //     //先让透明度为255\r\n    //     node.getChildByName('扣血s').opacity=255\r\n    //     fin_arr.push(cc.fadeOut(time));\r\n    //   }\r\n    //   fin_arr.push(cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n    //     node.getChildByName('扣血s').active=false\r\n    //   },this)) )\r\n    //   node.getChildByName('扣血s').runAction(fin_arr);\r\n    // },\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          // this.toolsArray.forEach(element => {\r\n          //     element.removeFromParent();\r\n          // });\r\n          cc.sys.toolsArray.forEach(element => {\r\n                element.removeFromParent();\r\n            });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    // reloadWord(){\r\n    //   var _this =this;\r\n    //   httpRequest.httpPost('/app/app-apiword/map-word',{}, function (data) {\r\n    //     //写入地图数据\r\n    //     _this.addWordMap(data)\r\n    //     })\r\n    // },\r\n    back_map(){\r\n      //移除节点\r\n      // var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      httpRequest.playGame(\"sence_ditu\")\r\n    },\r\n    //重播\r\n    back_reload(){\r\n      //移除节点\r\n      var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      _this.playTask( )\r\n      cc.find('Canvas/结算').active =false;// 结束弹窗结果\r\n    },\r\n    back_home(){\r\n      //移除节点\r\n      // var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      httpRequest.playGame(\"sence_dating\")\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n \r\n    // onDestroy() {\r\n    //     // 停止定时器\r\n    //     this.unschedule(this.fighting_history);\r\n    // }\r\n\r\n \r\n});\r\n"]}
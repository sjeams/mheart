{"version":3,"sources":["assets\\Script\\fighting\\score_fighting.js"],"names":["HttpHelper","require","httpRequest","params","cc","Class","Component","properties","toolsArray","fightingArray","content","Node","person","Prefab","home","reload","back","test_scrollView","type","ScrollView","test_pageView","PageView","init","director","getScene","onLoad","spawnTools","start","update","dt","_this","figthing_remote_url","sys","localStorage","getItem","playGame","remoteUrl","httpUrlJson","loader","load","url","err","data","removeAllChildren","destroyAllChildren","opacity","fin","fadeIn","runAction","star","init_postion","poition_my","biolgy_state","poition_enemy","addMapPic","fighting_list","fighting_history","length","boat","boat_length","log","schedule","map_pic","httpUrl","texture","getComponent","Sprite","spriteFrame","SpriteFrame","postion","int_px","is_my","TOOLS","total","maps","Map","i","map","biology","tool","instantiate","initInfo","x","parseInt","getChildByName","Label","string","y","biology_int","shengMing","moFa","id","biology_name","name","push","addChild","history","arr","h_length","his_log","go","need","putong","n","_this_hero_node","goid","_targ_hero_node","doid","buttonShake","buttonMove","node","m_node","m_x","m_y","actionLeft","moveBy","v2","scaleTo","actionRight","actionWaite","delayTime","actionFignthing","spawn","callFunc","active","Promise","resolve","sequence","actionhiddenOn","fadeTo","actionLeftSecond","actionRightSecond","actionhiddenoff","extend","hurt_msg","hurt_go_value","progressBar","ProgressBar","progress","completeCount","totalCount","getDistance","end","pos1","pos2","temp","sub","dis","Math","abs","mag","getAngle","dx","dy","dir","angle","signAngle","degree","PI","bagBtn","gridLayout","parent","forEach","element","removeFromParent","hp_update","hp","fill","all_hp","hp_now","fillstart","act_shan","repeat","reloadWord","httpPost","addWordMap","back_map","dynamicAtlasManager","reset","back_home","loadScene","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n// 世界操作  \r\nvar HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\nvar params =[];\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n            //测试item\r\n      //   content: {\r\n      //     default: null,\r\n      //     type: cc.Node\r\n      //   },\r\n\r\n      // person: {\r\n      //   default: null,\r\n      //   type: cc.Prefab\r\n      // },\r\n      // 根据TOOLS生成相应的道具\r\n      \r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      content: cc.Node,\r\n      person: cc.Prefab,\r\n      home: cc.Node,\r\n      reload: cc.Node,\r\n      back: cc.Node,\r\n      //列表\r\n      test_scrollView: {\r\n        default: null,\r\n        type: cc.ScrollView\r\n      },\r\n      //翻页容器\r\n      test_pageView: {\r\n        default: null,\r\n        type: cc.PageView\r\n      },\r\n\r\n    },\r\n    init(){\r\n      cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {\r\n\r\n      this.spawnTools()\r\n      \r\n    },\r\n    start () {\r\n      // console.log(this.toolsArray[0])\r\n      // var _this =this;\r\n      // var fighting_list = cc.sys.localStorage.getItem(\"fightingArray\");\r\n      // var fighting_list = JSON.parse(fighting_list);\r\n      // for (let boat=0; boat<fighting_list.fighting_history.length; boat++) {\r\n      //     _this.fighting_history(fighting_list.fighting_history[boat].fighting_history)//执行战斗顺序\r\n      // }\r\n    },\r\n    update (dt) {\r\n \r\n      // console.log(3333)\r\n    },\r\n \r\n    spawnTools () {\r\n      var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n         httpRequest.playGame('map/诸天地图');\r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n            // console.log(data) \r\n            // _this.addWordMap(results) //生成生物\r\n            // _self.node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture)\r\n            //移除节点\r\n            _this.content.removeAllChildren();\r\n            _this.content.destroyAllChildren();\r\n            //先让透明度为0\r\n            _this.content.opacity = 0;\r\n            var fin = cc.fadeIn(2);\r\n            _this.content.runAction(fin);\r\n            // 初始化阵容\r\n            var star =0; //阵容序号\r\n            var star = _this.init_postion(data.data.poition_my,data.data.biolgy_state,-0,1,star) //生成生物--position_my\r\n            var star = _this.init_postion(data.data.poition_enemy,data.data.biolgy_state,0,0,star) //生成生物--position_ememy\r\n            _this.addMapPic(data) //生成地图\r\n          // console.log( _this.toolsArray)\r\n          // const maps = new Map();\r\n         \r\n          // console.log( _this.fightingArray )\r\n              var fighting_list = data.data;     \r\n              //没有记录直接跳过  \r\n              if(fighting_list.fighting_history.length!=0){\r\n                var boat=-1;\r\n                var boat_length = fighting_list.fighting_history.length-1\r\n                //一条或多条执行语句\r\n\r\n                  cc.log(fighting_list.fighting_history)\r\n                    _this.schedule(function(){\r\n                    // for (let boat=0; boat<fighting_list.fighting_history.length; boat++) {\r\n                      boat++\r\n                      cc.log(boat)   \r\n                      cc.log(fighting_list.fighting_history[boat])   \r\n                        _this.fighting_history(fighting_list.fighting_history[boat].fighting_history)//执行战斗顺序                      \r\n                    // }\r\n                    },20,boat_length,3); //10秒后执行1次间隔5秒\r\n                // // var poition_my =fighting_list.poition_my\r\n                // // var poition_enemy =fighting_list.poition_enemy\r\n              }\r\n\r\n        });    \r\n      }\r\n    },\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n    //生成生物\r\n    init_postion(postion,biolgy_state,int_px,is_my,star){\r\n        var _this = this;\r\n        var TOOLS =[];\r\n        var TOOLS = postion;\r\n        var total = postion.length;\r\n        const maps = new Map();\r\n        //添加节点\r\n        for (let i=0; i<total; i++) {    \r\n            //死亡移除map_status\r\n            var map = TOOLS[i];\r\n            // console.log(map) \r\n            if(map.biology.length!=0){\r\n              star++;\r\n              var tool = cc.instantiate(_this.person);\r\n              tool.getComponent('fightingTools').initInfo(map.biology,biolgy_state,is_my);\r\n              tool.x=parseInt(map.x+int_px)\r\n              tool.getChildByName('阵法s').getComponent(cc.Label).string= star-1;\r\n              tool.y=map.y\r\n              tool.biology_int=star//阵法编号\r\n              tool.shengMing=map.biology.shengMing\r\n              tool.moFa=map.biology.moFa\r\n              tool.biology=map.biology.id\r\n              tool.biology_name=map.biology.name\r\n              _this.toolsArray.push(tool);\r\n              _this.fightingArray[map.biology.id]=tool;\r\n              // tool.setPosition(map.x,map.y);  \r\n              _this.content.addChild(tool); \r\n            }\r\n        }\r\n        return star;\r\n    },\r\n\r\n    fighting_history (history) {\r\n      cc.log(history)\r\n      var  arr = [];\r\n      var _this = this;\r\n      var i=-1;\r\n      // console.log(_this_hero_node);\r\n      var h_length = history.length-1;\r\n      _this.schedule(function(){\r\n          i++\r\n          var  his_log = history[i];\r\n          if(his_log.back.length!=0){\r\n\r\n          }\r\n          if(his_log.do.length!=0){\r\n            \r\n          }\r\n          if(his_log.go.length!=0){\r\n            \r\n          }\r\n          if(his_log.need.length!=0){\r\n           \r\n          }\r\n          if(his_log.putong.length!=0){\r\n            for (var n=0; n<his_log.putong.length; n++){\r\n              var biology = his_log.putong[n];\r\n              // console.log(_this.fightingArray[biology.goid]);\r\n              // console.log(_this.fightingArray[biology.doid]);\r\n              // var _this_hero_node =_this.toolsArray[_this.fightingArray[biology.goid]];\r\n              // var _targ_hero_node =_this.toolsArray[_this.fightingArray[biology.doid]];\r\n              var _this_hero_node =_this.fightingArray[biology.goid]\r\n              var _targ_hero_node =_this.fightingArray[biology.doid]\r\n              if(biology.goid==biology.doid){\r\n                //自己\r\n                  _this.buttonShake(_targ_hero_node,biology) //闪动\r\n              }else{\r\n                //移动\r\n                // _this.schedule(function(){\r\n                  _this.buttonMove(_this_hero_node,_targ_hero_node,biology) //移动\r\n                // },1);\r\n              }\r\n              // _this.buttonShake(_targ_hero_node) //闪动\r\n              // _this.buttonShake(_targ_hero_node) //闪动\r\n              // _this.buttonShake(_targ_hero_node) //闪动\r\n              // console.log(biology.doid) \r\n              // console.log(_targ_hero_node.x) \r\n              // console.log(_targ_hero_node.y) \r\n              // console.log(_targ_hero_node) \r\n              // arr.push(cc.rotateTo(0.5 ,5));\r\n              // arr.push(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y));\r\n              // // arr.push(cc.spawn(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y),cc.callFunc(function(){\r\n              // //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n              // //   _targ_hero_node.scale = 1;\r\n              // //   arr.push(cc.scaleBy(1,2));\r\n              // // },this)) );\r\n\r\n              // //等待攻击完成\r\n              // arr.push(cc.delayTime(0.5 + 1));\r\n              // //移回原来位置\r\n              // arr.push(cc.moveTo(2,_this_hero_node.x,_this_hero_node.y));\r\n              // // arr.push(cc.spawn(cc.moveTo(2,_this_hero_node.x,_this_hero_node.y),cc.callFunc(function(){\r\n              // //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n              // //   _targ_hero_node.scale = 1;\r\n              // //   arr.push(cc.scaleBy(1,2));\r\n              // // },this)) );\r\n              // arr.push(cc.rotateBy(0.5 ,-5));\r\n              // var act = cc.sequence(arr);\r\n              // _this_hero_node.runAction(act)\r\n              // 停止一个动作\r\n              // _this_hero_node.stopAction(act);\r\n              // // 停止所有动作\r\n              // _this_hero_node.stopAllActions();\r\n            }\r\n          // }\r\n          // his_log.need.forEach(element => {\r\n          //   console.log(element)\r\n          // })\r\n        }\r\n      },2,h_length,2);//只执行一次\r\n        //切换成冲刺动画，并移动到目标跟前  \r\n        // arr.push(cc.spawn(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y),cc.callFunc(function(){\r\n        //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n        //   _targ_hero_node.scale = 1;\r\n        //   arr.push(cc.scaleBy(1,2));\r\n        // },this)) );\r\n    \r\n        //播放攻击动画\r\n        // arr.push(cc.callFunc(function(){\r\n        //   // this.hero.playAnim(animName);\r\n        // },this));\r\n        // var animInfo = AnimConfig.getRoleInfo(this.hero.roleId)[animName];\r\n        // var playTime = animInfo.frames / animInfo.fps;\r\n\r\n        // arr.push(cc.callFunc(function(){\r\n        //     // this._isSpelling = false;\r\n        // },this));\r\n        \r\n      // }\r\n      // console.log(arr);\r\n\r\n\r\n\r\n\r\n      // console.log(_this_hero_node)\r\n      // for (let i=0; i<fighting.length; i++) {\r\n        // let action =  cc.speed(cc.sequence(cc.moveTo(5,400,200), cc.moveTo(5,this_node.x,this_node.y)),10)\r\n        // let action = cc.moveTo(1, 100, 100)\r\n        // cc.jumpTo(3, 200, 200, 50, 5)\r\n        // 执行动作，所有的动作都需要一个目标通过 runAction 去执行它\r\n        // this_node.runAction(action)\r\n      // }\r\n        //   // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n        //   for (let i=0; i<total; i++) {\r\n        //   this.toolsArray.forEach(element => {\r\n        //   //     var color = ['#FFFFFF','green','#BDFF00','#FFD100','#FF0000','#ffe000',];\r\n        //   //     // var type_color = color[info['yiXing']];\r\n        //   //     // console.log(info['color']);\r\n        //   //     element.getChildByName('生物').color = new cc.color(info['color']);\r\n        //   //     // console.log(info)\r\n        //   //     var star ='';    \r\n        //   //     for(i=0;i<=info['yiXing'];i++){\r\n        //   //         star +='⭐';\r\n        //   //     }\r\n        //   //     element.getChildByName('生命s').getComponent(cc.Label).string= info['shengMing']+'/'+info['shengMing'];\r\n        //   //     element.getChildByName('魔法s').getComponent(cc.Label).string= info['moFa']+'/'+info['moFa'];\r\n        //   //     element.getChildByName('生物名称s').getComponent(cc.Label).string= info['name'];\r\n        //   //     element.getChildByName('生物等级s').getComponent(cc.Label).string= 'Lv.'+info['grade']+'('+biolgy_state[info['state']]+')';\r\n        //   //     element.getChildByName('星星s').getComponent(cc.Label).string= star;\r\n        //   //     console.log(element)\r\n        //   //     // element.removeFromParent();\r\n        //   });\r\n        // }\r\n    },\r\n    buttonMove(node,m_node,biology) {\r\n      var _this =this;\r\n       m_x=10\r\n       m_x=0\r\n      if (node.x != m_node.x) m_x = m_node.x - node.x\r\n      if (node.y != m_node.y) m_y = m_node.y - node.y \r\n      // var m_x =m_x/200*100\r\n      // var m_y =m_y/200*100\r\n      cc.log(m_x)\r\n      cc.log(m_y)\r\n      // var y_end = this.getAngle(node,m_node)\r\n      // var actionLeft = cc.moveBy(0.5, cc.v2(x_end,0))\r\n      //   var actionRight = cc.moveBy(0.5, cc.v2(-x_end,0))\r\n      // 让节点在向上移动的同时缩放\r\n      // const actionBig = cc.scaleTo(0.1, 1, 1.4)\r\n      const actionLeft = cc.moveBy(0.5, cc.v2(m_x, m_y),cc.scaleTo(0.5, 1, 1.4));\r\n      const actionRight = cc.moveBy(0.5, cc.v2(-m_x,-m_y),cc.scaleTo(0.5, 1, 1.4));\r\n      const actionWaite = cc.delayTime(0.5);  \r\n      //等待攻击完成\r\n      _this.buttonShake(m_node,biology)\r\n      const actionFignthing = cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n        // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n          // node.scale = 1;\r\n          // arr.push(cc.scaleBy(1,2));\r\n          m_node.getChildByName('扣血s').active=false\r\n      },this))\r\n      // const actionLeftSecond = cc.moveBy(0.1, cc.v2(-10, 0));\r\n      // const actionRightSecond = cc.moveBy(0.1, cc.v2(5, 0));\r\n      return new Promise(resolve => {\r\n          node.runAction(\r\n              cc.sequence(actionLeft,actionRight,actionWaite,actionFignthing,\r\n              // 执行动作完成之后调用的方法\r\n                  cc.callFunc(() => {\r\n                      // cc.log(3333);\r\n                      // cc.log(33)\r\n             \r\n                      resolve();\r\n                  }))\r\n          );\r\n      });\r\n  },\r\n  \r\n  buttonShake(node,biology) {\r\n    // const actionWaite =cc.delayTime(0.5);    //等待攻击\r\n    const actionhiddenOn = cc .fadeTo(0.05,0);\r\n    const actionLeft = cc.moveBy(0.1, cc.v2(-5, 0));\r\n    const actionRight = cc.moveBy(0.1, cc.v2(10, 0));\r\n    const actionLeftSecond = cc.moveBy(0.1, cc.v2(-10, 0));\r\n    const actionRightSecond = cc.moveBy(0.1, cc.v2(5, 0));\r\n    const actionhiddenoff = cc.fadeTo(0.05,255);\r\n    // node.getChildByName('生命s').getComponent(cc.Label).string= info['shengMing']+'/'+info['shengMing'];\r\n    // node.getComponent(cc.ProgressBar).Progress\r\n    // cc.spwan( 同时完成\r\n    return new Promise(resolve => {\r\n        node.runAction(\r\n            cc.sequence(actionLeft, actionRight, actionLeftSecond, actionRightSecond,actionhiddenOn,actionhiddenoff,\r\n            // 执行动作完成之后调用的方法\r\n                cc.callFunc(() => {\r\n                    cc.log(node);\r\n                    cc.log(biology);\r\n                    if(biology.extend=='shengMing'){\r\n                      node.getChildByName('扣血s').active=true\r\n                      node.getChildByName('扣血s').getComponent(cc.Label).string=biology.hurt_msg\r\n                      node.getChildByName('生命s').getComponent(cc.Label).string= biology.hurt_go_value +'/'+ node.shengMing \r\n                      var progressBar = node.getChildByName('生命').getComponent(cc.ProgressBar)\r\n                      progressBar.progress = biology.hurt_go_value / node.shengMing\r\n                      // console.log(progressBar.progress)\r\n                      progressBar.completeCount = biology.hurt_go_value;\r\n                      progressBar.totalCount = node.shengMing;\r\n                      // if(biology.hurt_go_value==0){\r\n                      //   node.active=false;\r\n                      // }\r\n                    }\r\n                    if(biology.extend=='moFa'){\r\n                      node.getChildByName('魔法m').getComponent(cc.Label).string= biology.hurt_go_value+'/'+node.moFa\r\n                      var progressBar = node.getChildByName('魔法').getComponent(cc.ProgressBar)\r\n                      progressBar.progress = biology.hurt_go_value / node.moFa\r\n                      // console.log(progressBar.progress)\r\n                      progressBar.completeCount = biology.hurt_go_value;\r\n                      progressBar.totalCount = node.moFa;\r\n                    }\r\n                    resolve();\r\n                }))\r\n        );\r\n    });\r\n},\r\n  // 距离\r\n  getDistance(start,end){\r\n        // var pos = cc.v2(start.x - end.x, start.y - end.y);\r\n        // var dis = Math.sqrt(pos.x*pos.x + pos.y*pos.y)/6;\r\n        pos1=cc.v2(start.x ,0)\r\n        pos2=cc.v2(end.x ,0)\r\n        var temp=pos1.sub(pos2);\r\n        var dis=Math.abs(temp.mag());\r\n        return dis;\r\n    },\r\n  // 角度\r\n  getAngle(start,end){\r\n    //计算出朝向\r\n    var dx = end.x - start.x;\r\n      var dy = end.y - start.y;\r\n      var dir = cc.v2(dx,dy);\r\n\r\n      //根据朝向计算出夹角弧度\r\n      var angle = dir.signAngle(cc.v2(1,0));\r\n\r\n    //将弧度转换为欧拉角\r\n      var degree = angle / Math.PI * 180;\r\n      return -degree\r\n  },\r\n\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          this.toolsArray.forEach(element => {\r\n              element.removeFromParent();\r\n          });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    reloadWord(){\r\n      var _this =this;\r\n      httpRequest.httpPost('/app/app-apiword/map-word', params, function (data) {\r\n        //写入地图数据\r\n        _this.addWordMap(data)\r\n        })\r\n    },\r\n    back_map(){\r\n      //销毁动态合图\r\n      cc.dynamicAtlasManager.reset()\r\n      httpRequest.playGame('map/诸天地图');\r\n    },\r\n    back_home(){\r\n      //销毁动态合图\r\n      cc.dynamicAtlasManager.reset()\r\n      cc.director.loadScene('大厅');\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n      },\r\n    // start: function() {\r\n    //     this.start_y = this.content.y;\r\n    //     this.start_index = 0; // 当前我们24个Item加载的 100项数据里面的起始数据记录的索引;\r\n    //     this.load_record(this.start_index);\r\n    // },\r\n\r\n    // // 从这个索引开始，加载数据记录到我们的滚动列表里面的选项\r\n    // load_record: function(start_index) {\r\n    //     this.start_index = start_index;\r\n\r\n    //     for(var i = 0; i < this.PAGE_NUM * 3; i ++) {\r\n    //         var label = this.opt_item_set[i].getChildByName(\"src\").getComponent(cc.Label);\r\n    //         // 显示我们的记录;\r\n    //         label.string = this.value_set[start_index + i];\r\n    //     }\r\n    // },\r\n\r\n    // on_scroll_ended: function() {\r\n    //     this.scrollveiw_load_recode();\r\n    //     this.scroll_view.elastic = true;\r\n    // },\r\n\r\n    // scrollveiw_load_recode: function() {\r\n    //      // 向下加载了\r\n    //     if (this.start_index + this.PAGE_NUM * 3 < this.value_set.length &&\r\n    //         this.content.y >= this.start_y + this.PAGE_NUM * 2 * this.OPT_HEIGHT) { // 动态加载\r\n            \r\n    //         if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n    //             this.scroll_view.elastic = false; // 暂时关闭回弹效果\r\n    //             return;\r\n    //         }\r\n\r\n    //         var down_loaded = this.PAGE_NUM;\r\n    //         this.start_index += down_loaded;\r\n    //         if (this.start_index + this.PAGE_NUM * 3 > this.value_set.length) {\r\n    //             var out_len = this.start_index + this.PAGE_NUM * 3 - this.value_set.length;\r\n    //             down_loaded -= (out_len);\r\n    //             this.start_index -= (out_len);\r\n    //         }\r\n    //         this.load_record(this.start_index);\r\n\r\n    //         this.content.y -= (down_loaded * this.OPT_HEIGHT);\r\n    //         return;\r\n    //     }\r\n\r\n    //     // 向上加载\r\n    //     if (this.start_index > 0 && this.content.y <= this.start_y) {\r\n    //         if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n    //             this.scroll_view.elastic = false;\r\n    //             return;\r\n    //         }\r\n\r\n    //         var up_loaded = this.PAGE_NUM;\r\n    //         this.start_index -= up_loaded;\r\n    //         if (this.start_index < 0) {\r\n    //             up_loaded += this.start_index;\r\n    //             this.start_index = 0; \r\n    //         }\r\n    //         this.load_record(this.start_index);\r\n    //         this.content.y += (up_loaded * this.OPT_HEIGHT);\r\n    //     }\r\n    //     // end \r\n    // },\r\n    // // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n    //     this.scrollveiw_load_recode();\r\n    // },\r\n});\r\n"]}
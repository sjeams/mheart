{"version":3,"sources":["assets\\Script\\fighting\\score_fighting.js"],"names":["HttpHelper","require","httpRequest","params","cc","Class","Component","properties","toolsArray","fightingArray","content","Node","person","Prefab","home","reload","back","test_scrollView","type","ScrollView","test_pageView","PageView","init","director","getScene","onLoad","spawnTools","start","update","dt","_this","figthing_remote_url","sys","localStorage","getItem","playGame","remoteUrl","httpUrlJson","loader","load","url","err","data","star","init_postion","poition_my","biolgy_state","poition_enemy","addMapPic","fighting_list","fighting_history","length","boat","boat_length","schedule","unschedule","fightingEnd","find","getComponent","Label","string","parseInt","loadRes","errorMessage","loadedResource","log","TipBoxPrefab","instantiate","poition_winner","getChildByName","addChild","map_pic","httpUrl","texture","Sprite","spriteFrame","SpriteFrame","postion","int_px","is_my","TOOLS","total","i","map","biology","tool","initInfo","x","y","biology_int","shengMing","moFa","id","biology_name","name","push","randomNumup","Math","floor","random","randomNumdown","seq","repeatForever","sequence","moveBy","runAction","history","arr","ipage","h_length","his_log","h_need","playFight","h_putong","readySkill","playSkill","his_log_extend","n","_this_hero_node","goid","_targ_hero_node","doid","buttonShake","buttonMove","node","m_node","m_x","m_y","spawn","scaleTo","callFunc","delayTime","v2","Promise","resolve","console","waite_time","actionWaite","actionhiddenOn","fadeTo","actionLeft","actionRight","actionLeftSecond","actionRightSecond","actionhiddenoff","extend","color","hurt_msg","hurt_go_value","progressBar","ProgressBar","progress","completeCount","totalCount","active","opacity","fadeOut","fadeIn","bagBtn","gridLayout","parent","forEach","element","removeFromParent","hp_update","hp","fill","all_hp","hp_now","fillstart","act_shan","repeat","reloadWord","httpPost","addWordMap","back_map","dynamicAtlasManager","reset","back_reload","back_home","loadScene","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n// 世界操作  \r\nvar HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\nvar params =[];\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n      // 根据TOOLS生成相应的道具\r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      content: cc.Node,\r\n      person: cc.Prefab,\r\n      home: cc.Node,\r\n      reload: cc.Node,\r\n      back: cc.Node,\r\n      //列表\r\n      test_scrollView: {\r\n        default: null,\r\n        type: cc.ScrollView\r\n      },\r\n      //翻页容器\r\n      test_pageView: {\r\n        default: null,\r\n        type: cc.PageView\r\n      },\r\n\r\n    },\r\n    init(){\r\n      cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {\r\n\r\n      this.spawnTools()\r\n      \r\n    },\r\n    start () {\r\n    },\r\n    update (dt) {\r\n      // console.log(3333)\r\n    },\r\n    spawnTools () {\r\n      var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n         httpRequest.playGame('map/诸天地图');\r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n            // console.log(data) \r\n            //移除节点\r\n            // _this.content.removeAllChildren();\r\n            // _this.content.destroyAllChildren();\r\n            //先让透明度为0\r\n            // _this.nodefadeIn(1,0,_this.content)\r\n            // 初始化阵容\r\n            var star =0; //阵容序号\r\n            var star = _this.init_postion(data.data.poition_my,data.data.biolgy_state,-0,1,star) //生成生物--position_my\r\n            var star = _this.init_postion(data.data.poition_enemy,data.data.biolgy_state,0,0,star) //生成生物--position_ememy\r\n            _this.addMapPic(data) //生成地图\r\n          // console.log( _this.toolsArray)\r\n          // console.log( _this.fightingArray )\r\n            var fighting_list = data.data;    \r\n            // cc.log( fighting_list )\r\n            // _this.fightingEnd(fighting_list)\r\n            // return false\r\n            //没有记录直接跳过  \r\n            if(fighting_list.fighting_history.length!=0){\r\n            \r\n              var boat=-1;\r\n              var boat_length = fighting_list.fighting_history.length\r\n              //一条或多条执行语句\r\n              _this.schedule(function(){\r\n              // for (let boat=0; boat<fighting_list.fighting_history.length; boat++) {\r\n                boat++\r\n                // cc.log(boat)   \r\n                if (boat == boat_length) {\r\n                    this.unschedule();\r\n                      // 在第六次执行回调时取消这个计时器\r\n                    _this.fightingEnd(fighting_list)\r\n                }else{\r\n               \r\n                  cc.find('Canvas/大厅/回合/time').getComponent(cc.Label).string = '回合'+ parseInt(boat+1) \r\n                  // cc.log(fighting_list.fighting_history)\r\n                  // cc.log(fighting_list.fighting_history[boat])   \r\n                  _this.fighting_history(fighting_list.fighting_history[boat].fighting_history)//执行战斗顺序      \r\n                }                \r\n              // }\r\n              },10,boat_length,2); //10秒后执行1次间隔5秒\r\n              // // var poition_my =fighting_list.poition_my\r\n              // // var poition_enemy =fighting_list.poition_enemy\r\n            }\r\n            \r\n        });    \r\n      }\r\n    },\r\n      //战斗结束\r\n    fightingEnd(fighting_list) {\r\n        // var _task =task||0;\r\n        var _this =this;\r\n        //加载预制资源 PrefabUrl为 预制资源在 资源中的路径\r\n        cc.loader.loadRes('/biology_结算', function(errorMessage,loadedResource){\r\n            //检查资源加载\r\n            if( errorMessage ) { cc.log( '载入预制资源失败, 原因:' + errorMessage ); return; }\r\n            if( !(loadedResource instanceof cc.Prefab ) ) { cc.log( '你载入的不是预制资源!' ); return; }\r\n            //开始实例化预制资源\r\n            var TipBoxPrefab = cc.instantiate(loadedResource);\r\n            // TipBoxPrefab.getComponent('fightingTools').initInfo(fighting_list); //写入奖励物品预制体\r\n            if(fighting_list.poition_winner==1){\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='胜利！';\r\n            }else{\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='失败！';\r\n            }\r\n            //将预制资源添加到父节点\r\n            // CanvasNode.addChild(TipBoxPrefab);\r\n            cc.find('Canvas').addChild(TipBoxPrefab,1);\r\n            //请求战斗记录\r\n            // if(_task==1){\r\n            //     console.log(11111)\r\n            //     _this.fightint(sence);\r\n            // }else{\r\n            //     _this.progress(sence);\r\n            // }\r\n\r\n        });\r\n    },\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n    //生成生物\r\n    init_postion(postion,biolgy_state,int_px,is_my,star){\r\n        var _this = this;\r\n        var TOOLS =[];\r\n        var TOOLS = postion;\r\n        var total = postion.length;\r\n        // const maps = new Map();\r\n    \r\n        //添加节点\r\n        for (let i=0; i<total; i++) {    \r\n            //死亡移除map_status\r\n            var map = TOOLS[i];\r\n            // console.log(map) \r\n            if(map.biology.length!=0){\r\n              star++;\r\n              var tool = cc.instantiate(_this.person);\r\n              tool.getComponent('fightingTools').initInfo(map.biology,biolgy_state,is_my);\r\n              tool.x=parseInt(map.x+int_px)\r\n              tool.getChildByName('阵法s').getComponent(cc.Label).string= star-1;\r\n              tool.y=map.y\r\n              tool.biology_int=star//阵法编号\r\n              tool.shengMing=map.biology.shengMing\r\n              tool.moFa=map.biology.moFa\r\n              tool.biology=map.biology.id\r\n              tool.biology_name=map.biology.name\r\n              _this.toolsArray.push(tool);\r\n              _this.fightingArray[map.biology.id]=tool;\r\n              //永久重复移动\r\n              var randomNumup = Math.floor(Math.random() * (5 - 1 + 1)) + 1;\r\n              var randomNumdown = Math.floor(Math.random() * (5 - 1 + 1)) + 1;\r\n              var seq = cc.repeatForever(\r\n                cc.sequence(\r\n                    cc.moveBy(randomNumup, 0, 5),\r\n                    cc.moveBy(randomNumdown, 0, -5)\r\n                ));\r\n              tool.runAction(seq);\r\n              // tool.setPosition(map.x,map.y);  \r\n              _this.content.addChild(tool); \r\n            }\r\n        }\r\n        return star;\r\n    },\r\n\r\n    fighting_history (history) {\r\n      var  arr = [];\r\n      var _this = this;\r\n      var ipage=-1;\r\n      // console.log(_this_hero_node);\r\n      var h_length = history.length-1<0?0:history.length-1;\r\n      _this.schedule(function(){\r\n          ipage++\r\n          let  his_log = history[ipage];\r\n          // cc.log(his_log)\r\n          // cc.log(his_log.h_putong.length)\r\n      \r\n          //反击\r\n          // if(his_log.h_back.length!=0){\r\n          //   _this.playFight(_targ_hero_node,_this_hero_node,biology,his_log.h_back)\r\n          // }\r\n          // //执行技能\r\n          // if(his_log.h_do.length!=0){\r\n          //   _this.readySkill(_this_hero_node,_targ_hero_node,biology,his_log.h_do)\r\n          // }\r\n          // //发起技能\r\n          // if(his_log.h_go.length!=0){\r\n          //   _this.playSkill(_this_hero_node,_targ_hero_node,biology,his_log.h_go)\r\n          // }\r\n          //消耗魔法\r\n          if(his_log.h_need.length!=0){\r\n            _this.playFight(his_log.h_need)\r\n          }\r\n          //普通攻击\r\n          if(his_log.h_putong.length!=0){\r\n            _this.playFight(his_log.h_putong)\r\n          }\r\n      },1.5,h_length,1);//只执行一次\r\n        //切换成冲刺动画，并移动到目标跟前  \r\n        // arr.push(cc.spawn(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y),cc.callFunc(function(){\r\n        //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n        //   _targ_hero_node.scale = 1;\r\n        //   arr.push(cc.scaleBy(1,2));\r\n        // },this)) );\r\n    \r\n        //播放攻击动画\r\n        // arr.push(cc.callFunc(function(){\r\n        //   // this.hero.playAnim(animName);\r\n        // },this));\r\n        // var animInfo = AnimConfig.getRoleInfo(this.hero.roleId)[animName];\r\n        // var playTime = animInfo.frames / animInfo.fps;\r\n\r\n        // arr.push(cc.callFunc(function(){\r\n        //     // this._isSpelling = false;\r\n        // },this));\r\n        \r\n      // }\r\n      // console.log(arr);\r\n      // console.log(_this_hero_node)\r\n      // for (let i=0; i<fighting.length; i++) {\r\n        // let action =  cc.speed(cc.sequence(cc.moveTo(5,400,200), cc.moveTo(5,this_node.x,this_node.y)),10)\r\n        // let action = cc.moveTo(1, 100, 100)\r\n        // cc.jumpTo(3, 200, 200, 50, 5)\r\n        // 执行动作，所有的动作都需要一个目标通过 runAction 去执行它\r\n        // this_node.runAction(action)\r\n      // }\r\n    },\r\n    readySkill(){\r\n\r\n    },\r\n    playSkill(){\r\n\r\n    },\r\n    playFight(his_log_extend){\r\n\r\n      var _this =this\r\n      for (var n=0; n<his_log_extend.length; n++){\r\n        var biology = his_log_extend[n];\r\n        // cc.log(this.fightingArray)\r\n        var _this_hero_node =this.fightingArray[biology.goid]\r\n        var _targ_hero_node =this.fightingArray[biology.doid]\r\n        if(biology.goid==biology.doid){\r\n          //自己\r\n            _this.buttonShake(0,_targ_hero_node,biology) //闪动\r\n        }else{\r\n          //移动\r\n          // _this.schedule(function(){\r\n            _this.buttonMove(_this_hero_node,_targ_hero_node,biology) //移动\r\n          // },1);\r\n        }\r\n        // arr.push(cc.rotateTo(0.5 ,5));\r\n        // arr.push(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y));\r\n        // // arr.push(cc.spawn(cc.moveTo(2,_targ_hero_node.x,_targ_hero_node.y),cc.callFunc(function(){\r\n        // //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n        // //   _targ_hero_node.scale = 1;\r\n        // //   arr.push(cc.scaleBy(1,2));\r\n        // // },this)) );\r\n\r\n        // //等待攻击完成\r\n        // arr.push(cc.delayTime(0.5 + 1));\r\n        // //移回原来位置\r\n        // arr.push(cc.moveTo(2,_this_hero_node.x,_this_hero_node.y));\r\n        // // arr.push(cc.spawn(cc.moveTo(2,_this_hero_node.x,_this_hero_node.y),cc.callFunc(function(){\r\n        // //   // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n        // //   _targ_hero_node.scale = 1;\r\n        // //   arr.push(cc.scaleBy(1,2));\r\n        // // },this)) );\r\n        // arr.push(cc.rotateBy(0.5 ,-5));\r\n        // var act = cc.sequence(arr);\r\n        // _this_hero_node.runAction(act)\r\n        // 停止一个动作\r\n        // _this_hero_node.stopAction(act);\r\n        // // 停止所有动作\r\n        // _this_hero_node.stopAllActions();\r\n      }\r\n    },\r\n    buttonMove(node,m_node,biology) {\r\n      var arr =[];\r\n      var _this =this;\r\n      var m_x=10\r\n      var m_y=0\r\n      if (node.x != m_node.x) m_x = m_node.x - node.x\r\n      if (node.y != m_node.y) m_y = m_node.y - node.y \r\n      // var m_x =m_x/200*100\r\n      // var m_y =m_y/200*100\r\n      // cc.log(m_x)\r\n      // cc.log(m_y)\r\n      arr.push(cc.spawn(cc.moveBy(0.5,m_x,m_y),cc.scaleTo(0.1, 1, 1.2),cc.callFunc(function(){\r\n      // _this_hero_node.playAnim('/biology_pic/3关闭');\r\n      //等待攻击完成\r\n      _this.buttonShake(0.5,m_node,biology)\r\n      },this)) );\r\n      arr.push( cc.delayTime(0.5))\r\n      arr.push( cc.moveBy(0.5, cc.v2(-m_x,-m_y),cc.scaleTo(0.5, 1, 1.4)))\r\n      // 让节点在向上移动的同时缩放\r\n      arr.push(cc.scaleTo(0.1, 1,1))\r\n\r\n      return new Promise(resolve => {\r\n          node.runAction(\r\n              cc.sequence(arr,cc.callFunc(() => {       \r\n                  console.log(11)\r\n                resolve();\r\n              }))\r\n          );\r\n      });\r\n  },\r\n  \r\n  buttonShake(waite_time,node,biology) {\r\n    var waite_time=waite_time||0\r\n    const actionWaite =cc.delayTime(waite_time);//等待攻击时间\r\n    const actionhiddenOn = cc.fadeTo(0.05,0);\r\n    const actionLeft = cc.moveBy(0.1, cc.v2(-5, 0));\r\n    const actionRight = cc.moveBy(0.1, cc.v2(10, 0));\r\n    const actionLeftSecond = cc.moveBy(0.1, cc.v2(-10, 0));\r\n    const actionRightSecond = cc.moveBy(0.1, cc.v2(5, 0));\r\n    const actionhiddenoff = cc.fadeTo(0.05,255);\r\n    // cc.spwan( 同时完成\r\n    return new Promise(resolve => {\r\n        node.runAction(\r\n            cc.sequence(actionWaite,actionLeft, actionRight, actionLeftSecond, actionRightSecond,actionhiddenOn,actionhiddenoff,\r\n            // 执行动作完成之后调用的方法\r\n                cc.callFunc(() => {\r\n                    // cc.log(node);\r\n                    // cc.log(biology);\r\n                    var _this = this\r\n                    if(biology.extend=='shengMing'){\r\n                      node.getChildByName('扣血s').color = new cc.color('FF0000');\r\n                      node.getChildByName('扣血s').getComponent(cc.Label).string= biology.hurt_msg\r\n                      node.getChildByName('生命s').getComponent(cc.Label).string= biology.hurt_go_value +'/'+ node.shengMing \r\n                      var progressBar = node.getChildByName('生命').getComponent(cc.ProgressBar)\r\n                      progressBar.progress = biology.hurt_go_value / node.shengMing\r\n                      progressBar.completeCount = biology.hurt_go_value;\r\n                      progressBar.totalCount = node.shengMing;\r\n                      //扣血渐隐\r\n                      node.getChildByName('扣血s').active=true\r\n                      node.getChildByName('扣血s').opacity=255\r\n                      node.getChildByName('扣血s').runAction(cc.fadeOut(1),cc.callFunc(function(){  node.getChildByName('扣血s').active=false },this));\r\n\r\n                      node.getChildByName('受伤').active=true\r\n                      node.getChildByName('受伤').opacity=255\r\n                      node.getChildByName('受伤').runAction(cc.fadeOut(1),cc.callFunc(function(){  node.getChildByName('受伤').active=false },this));\r\n                      if(biology.hurt_go_value==0){\r\n                        node.getChildByName('悟性').active=false\r\n                        node.getChildByName('生命').active=false\r\n                        node.getChildByName('魔法').active=false\r\n                        node.getChildByName('悟性s').active=false\r\n                        node.getChildByName('生命s').active=false\r\n                        node.getChildByName('魔法s').active=false\r\n                        node.getChildByName('生物').active=false\r\n                        // 死亡\r\n                        node.getChildByName('受伤').active=true\r\n                        cc.loader.loadRes('biology_pic/1死亡之花', function (err, texture) {  \r\n                          node.getChildByName('受伤').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n                        })\r\n                        node.getChildByName('受伤').runAction(cc.fadeIn(1),cc.callFunc(function(){  node.getChildByName('受伤').active=false },this));\r\n                        //   node.active=false;\r\n                      }\r\n                    }\r\n                    if(biology.extend=='moFa'){\r\n                      node.getChildByName('扣血s').color = new cc.color('#3568D5');\r\n                      node.getChildByName('扣血s').getComponent(cc.Label).string= biology.hurt_msg\r\n                      node.getChildByName('魔法s').getComponent(cc.Label).string= biology.hurt_go_value+'/'+node.moFa\r\n                      var progressBar = node.getChildByName('魔法').getComponent(cc.ProgressBar)\r\n                      progressBar.progress = biology.hurt_go_value / node.moFa\r\n                      progressBar.completeCount = biology.hurt_go_value;\r\n                      progressBar.totalCount = node.moFa;\r\n                      //扣蓝渐隐\r\n                      node.getChildByName('扣血s').active=true\r\n                      node.getChildByName('扣血s').opacity=255\r\n                      node.getChildByName('扣血s').runAction(cc.fadeOut(1),cc.callFunc(function(){  node.getChildByName('扣血s').active=false },this));\r\n                    }\r\n                    resolve();\r\n                }) )\r\n        );\r\n    });\r\n},\r\n    //生物渐隐-淡出-淡入\r\n    // nodefadeIn(time,type,node){\r\n    //   // cc.log(node)\r\n    //   var fin_arr=[];\r\n    //   if(type==0){\r\n    //     //先让透明度为0\r\n    //     node.getChildByName('扣血s').opacity=0\r\n    //     fin_arr.push(cc.fadeIn(time));\r\n    //   }else{\r\n    //     //先让透明度为255\r\n    //     node.getChildByName('扣血s').opacity=255\r\n    //     fin_arr.push(cc.fadeOut(time));\r\n    //   }\r\n    //   fin_arr.push(cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n    //     node.getChildByName('扣血s').active=false\r\n    //   },this)) )\r\n    //   node.getChildByName('扣血s').runAction(fin_arr);\r\n    // },\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          this.toolsArray.forEach(element => {\r\n              element.removeFromParent();\r\n          });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    reloadWord(){\r\n      var _this =this;\r\n      httpRequest.httpPost('/app/app-apiword/map-word', params, function (data) {\r\n        //写入地图数据\r\n        _this.addWordMap(data)\r\n        })\r\n    },\r\n    back_map(){\r\n      //销毁动态合图\r\n      cc.dynamicAtlasManager.reset()\r\n      httpRequest.playGame('map/诸天地图');\r\n    },\r\n    back_reload(){\r\n      // this.parent.active=false\r\n      //销毁动态合图\r\n      cc.dynamicAtlasManager.reset()\r\n      httpRequest.playGame('战斗场景');\r\n    },\r\n    back_home(){\r\n      //销毁动态合图\r\n      cc.dynamicAtlasManager.reset()\r\n      cc.director.loadScene('大厅');\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n \r\n});\r\n"]}
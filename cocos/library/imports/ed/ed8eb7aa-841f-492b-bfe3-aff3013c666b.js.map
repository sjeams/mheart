{"version":3,"sources":["assets\\Script\\fighting\\score_fighting.js"],"names":["HttpHelper","require","httpRequest","FightingExtend","getFightingExtend","params","cc","Class","Component","properties","toolsArray","fightingArray","content","Node","person","Prefab","home","reload","back","test_scrollView","type","ScrollView","test_pageView","PageView","init","director","getScene","onLoad","spawnTools","start","update","dt","_this","figthing_remote_url","sys","localStorage","getItem","playGame","urlConfig","remoteUrl","httpUrlJson","loader","load","url","err","data","star","init_postion","poition_my","biolgy_state","poition_enemy","fighting_list","boat_length","fighting_history","length","history_count","boat","boat_count","schedule","total","fightingEnd","unschedule","find","getComponent","Label","string","parseInt","runAction","sequence","scaleTo","his_log","h_need","readySkill","h_go","playSkill","h_do","h_putong","playFight","loadRes","errorMessage","loadedResource","log","TipBoxPrefab","instantiate","poition_winner","getChildByName","addChild","addMapPic","map_pic","httpUrl","texture","Sprite","spriteFrame","SpriteFrame","postion","int_px","is_my","TOOLS","i","map","biology","tool","initInfo","x","y","jing_bi","jingBi","biology_int","shengMing","moFa","id","biology_name","name","push","his_log_extend","npage","_this_hero_node","goid","_targ_hero_node","doid","buttonReady","Promise","resolve","needSkill","playAction","buttonMove","waite_time","node","actionhiddenBig","actionhiddenOn","fadeTo","actionhiddenoff","actionhiddenSmoll","callFunc","playTips","m_node","arr","m_x","m_y","m_x_move","actionLeft","spawn","moveBy","v2","actionRight","buttonShake","actionWaite","delayTime","actionLeftSecond","actionRightSecond","bagBtn","gridLayout","parent","active","forEach","element","removeFromParent","hp_update","hp","fill","all_hp","hp_now","fillstart","act_shan","repeat","reloadWord","httpPost","addWordMap","back_map","removeAllChildren","destroyAllChildren","back_reload","back_home","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd"],"mappings":"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","sourceRoot":"/","sourcesContent":["// 世界操作  \r\nvar HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\nvar FightingExtend = require(\"figthingExtend\"); \r\nvar getFightingExtend = new FightingExtend();\r\n// var httpRequest = new HttpHelper();\r\nvar params =[];\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n      // 根据TOOLS生成相应的道具\r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      content: cc.Node,\r\n      person: cc.Prefab,\r\n      home: cc.Node,\r\n      reload: cc.Node,\r\n      back: cc.Node,\r\n      //列表\r\n      test_scrollView: {\r\n        default: null,\r\n        type: cc.ScrollView\r\n      },\r\n      //翻页容器\r\n      test_pageView: {\r\n        default: null,\r\n        type: cc.PageView\r\n      },\r\n\r\n    },\r\n    init(){\r\n      cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {\r\n\r\n      this.spawnTools()\r\n      \r\n    },\r\n    start () {\r\n    },\r\n    update (dt) {\r\n      // console.log(3333)\r\n    },\r\n    spawnTools () {\r\n      var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n          httpRequest.playGame(httpRequest.urlConfig(\"sence_ditu\"));\r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n            // console.log(data) \r\n            //移除节点\r\n            // _this.content.removeAllChildren();\r\n            // _this.content.destroyAllChildren();\r\n            //先让透明度为0\r\n            // _this.nodefadeIn(1,0,_this.content)\r\n            // 初始化阵容\r\n            var star =0; //阵容序号\r\n            var star = _this.init_postion(data.data.poition_my,data.data.biolgy_state,-0,1,star) //生成生物--position_my\r\n            var star = _this.init_postion(data.data.poition_enemy,data.data.biolgy_state,0,0,star) //生成生物--position_ememy\r\n            // _this.addMapPic(data) //生成地图\r\n          // console.log( _this.toolsArray)\r\n          // console.log( _this.fightingArray )\r\n            var fighting_list = data.data;    \r\n            var boat_length = fighting_list.fighting_history.length\r\n            var history_count =  fighting_list.history_count\r\n            var fighting_history= fighting_list.fighting_history;\r\n \r\n            if(boat_length!=0){\r\n              var boat=0;\r\n              var boat_count=-1;\r\n              //一条或多条执行语句\r\n              // _this.schedule(function(){\r\n              //循环历史行动条数\r\n              _this.schedule(function(){\r\n                  boat_count++\r\n                  if(history_count[boat].total<boat_count){\r\n                    boat++;\r\n                  }\r\n                  //因为是从0开始，所以相等就结束 \r\n                  if(boat_count==boat_length){\r\n                    // cc.log(111)\r\n                    // 在第六次执行回调时取消这个计时器\r\n                    _this.fightingEnd(fighting_list)\r\n                    _this.unschedule();\r\n                  }else{\r\n                    //判断下动作是否已经下一回合\r\n                    if(cc.find('Canvas/大厅/time').getComponent(cc.Label).string!='第'+ parseInt(boat+1)+'回合' ){\r\n                      cc.find('Canvas/大厅/time').getComponent(cc.Label).string = '第'+ parseInt(boat+1)+'回合'                    \r\n                      cc.find('Canvas/大厅/time').runAction(cc.sequence(cc.scaleTo(0.3, 2, 2),cc.scaleTo(0.3, 1,1)));//建一个缩放到1.5倍大小的动作，持续时间2秒\r\n                    }\r\n                    // cc.log(fighting_history[boat_count])\r\n                    _this.fighting_history(fighting_history[boat_count])//执行战斗顺序 \r\n                  }\r\n              },1,boat_length,0.3);////10秒后执行1次间隔5秒\r\n            }\r\n        });    \r\n      }\r\n    },\r\n    fighting_history(his_log) {\r\n      // cc.log(his_log)\r\n      var _this = this;\r\n      //反击\r\n      // if(his_log.h_back.length!=0){\r\n      //   _this.playFight(_this_hero_node,_targ_hero_node,biology,his_log.h_back)\r\n      // }\r\n      //消耗魔法 --技能名称和消耗放一起了\r\n      if(his_log.h_need.length!=0){\r\n        _this.readySkill(his_log.h_need)\r\n      }\r\n\r\n      //go和do 二选一 ，need 必有   \r\n      // 发起技能名称被动\r\n      if(his_log.h_go.length!=0){\r\n        _this.playSkill(his_log.h_go)\r\n      }\r\n      // 执行技能\r\n      if(his_log.h_do.length!=0){\r\n        _this.playSkill(his_log.h_do)\r\n      }\r\n      //普通攻击\r\n      if(his_log.h_putong.length!=0){\r\n        _this.playFight(his_log.h_putong)\r\n      }\r\n    },\r\n      //战斗结束\r\n    fightingEnd(fighting_list) {\r\n        // var _task =task||0;\r\n        var _this =this;\r\n        //加载预制资源 PrefabUrl为 预制资源在 资源中的路径\r\n        cc.loader.loadRes('/biology_结算', function(errorMessage,loadedResource){\r\n            //检查资源加载\r\n            if( errorMessage ) { cc.log( '载入预制资源失败, 原因:' + errorMessage ); return; }\r\n            if( !(loadedResource instanceof cc.Prefab ) ) { cc.log( '你载入的不是预制资源!' ); return; }\r\n            //开始实例化预制资源\r\n            var TipBoxPrefab = cc.instantiate(loadedResource);\r\n            // TipBoxPrefab.getComponent('fightingTools').initInfo(fighting_list); //写入奖励物品预制体\r\n            if(fighting_list.poition_winner==1){\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='胜利！';\r\n            }else{\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='失败！';\r\n            }\r\n            //将预制资源添加到父节点\r\n            // CanvasNode.addChild(TipBoxPrefab);\r\n            cc.find('Canvas').addChild(TipBoxPrefab,1);\r\n            //请求战斗记录\r\n            // if(_task==1){\r\n            //     console.log(11111)\r\n            //     _this.fightint(sence);\r\n            // }else{\r\n            //     _this.progress(sence);\r\n            // }\r\n        });\r\n    },\r\n\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n    //生成生物\r\n    init_postion(postion,biolgy_state,int_px,is_my,star){\r\n        var _this = this;\r\n        var TOOLS =[];\r\n        var TOOLS = postion;\r\n        var total = postion.length;\r\n        // const maps = new Map();\r\n        //添加节点\r\n        for (let i=0; i<total; i++) {    \r\n            //死亡移除map_status\r\n            var map = TOOLS[i];\r\n            // console.log(map) \r\n            if(map.biology.length!=0){\r\n              star++;\r\n              var tool = cc.instantiate(_this.person);\r\n              tool.getComponent('fightingTools').initInfo(map.biology,biolgy_state,is_my);\r\n              tool.x=parseInt(map.x+int_px)\r\n              tool.getChildByName('阵法s').getComponent(cc.Label).string= star-1;\r\n              tool.y=map.y\r\n              tool.is_my=is_my//阵容\r\n              tool.jing_bi=map.biology.jingBi//金币\r\n              tool.biology_int=star//阵法编号\r\n              tool.shengMing=map.biology.shengMing\r\n              tool.moFa=map.biology.moFa\r\n              tool.biology=map.biology.id\r\n              tool.biology_name=map.biology.name\r\n              _this.toolsArray.push(tool);\r\n              _this.fightingArray[map.biology.id]=tool;\r\n              //永久重复移动\r\n              // var randomNumup = Math.floor(Math.random() * (5 - 1 + 1)) + 1;\r\n              // var randomNumdown = Math.floor(Math.random() * (5 - 1 + 1)) + 1;\r\n              // var seq = cc.repeatForever(\r\n              //   cc.sequence(\r\n              //       cc.moveBy(randomNumup, 0,5),\r\n              //       // cc.scaleTo(randomNumup, 1, 1.05),\r\n              //       // cc.scaleTo(randomNumdown, 1.05,1),\r\n              //       cc.moveBy(randomNumdown, 0,-5)\r\n              //   ));\r\n              // tool.runAction(seq);\r\n        \r\n              _this.content.addChild(tool); \r\n            }\r\n        }\r\n        return star;\r\n    },\r\n\r\n\r\n    //技能准备动作\r\n    readySkill(his_log_extend){\r\n      // console.log(his_log_extend)\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          var _this_hero_node =this.fightingArray[biology.goid]\r\n          var _targ_hero_node =this.fightingArray[biology.doid]\r\n          _this.buttonReady(0,_this_hero_node,biology)//自己变大--加载技能动作\r\n          }\r\n      } \r\n      return new Promise(resolve => {resolve();})\r\n    },\r\n    //技能消耗动作\r\n    needSkill(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(biology)\r\n          var _this_hero_node =this.fightingArray[biology.goid]\r\n          var _targ_hero_node =this.fightingArray[biology.doid]\r\n          // _this.buttonShake(0.5,_targ_hero_node,biology)//技能攻击\r\n          // _this.schedule(function(){\r\n          getFightingExtend.playAction(_targ_hero_node,biology,0) //不需要其它动作，瞬发伤害动作\r\n          // },1)\r\n        }\r\n      }\r\n      return new Promise(resolve => {resolve();})\r\n    },\r\n    //技能攻击动作\r\n    playSkill(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(biology)\r\n          var _this_hero_node =this.fightingArray[biology.goid]\r\n          var _targ_hero_node =this.fightingArray[biology.doid]\r\n          //2个攻击类型只能二选一 \r\n          // _this.buttonShake(0.1,_targ_hero_node,biology)//技能攻击，动作后伤害\r\n            getFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n        }\r\n      }\r\n      return new Promise(resolve => {resolve();})\r\n    },\r\n    //普通攻击动作\r\n    playFight(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(this.fightingArray)\r\n          var _this_hero_node =this.fightingArray[biology.goid]\r\n          var _targ_hero_node =this.fightingArray[biology.doid]\r\n          if(biology.goid==biology.doid){\r\n              // _this.buttonShake(0,_targ_hero_node,biology)//自己闪动\r\n            _this.buttonReady(0,_this_hero_node,biology)//自己变大--加载技能动作\r\n          }else{\r\n            _this.buttonMove(0.1,_this_hero_node,_targ_hero_node,biology) //移动\r\n          }\r\n        }\r\n      }\r\n      return new Promise(resolve => {resolve();})\r\n    },\r\n    //准备动作--变大\r\n    buttonReady(waite_time,node,biology) {\r\n        var _this =this\r\n        var waite_time=waite_time||0\r\n        const actionhiddenBig =  cc.scaleTo(0.2, 1.2, 1.2);//变大\r\n        // const actionWaite =cc.delayTime(waite_time);//等待攻击时间\r\n        const actionhiddenOn = cc.fadeTo(0.05,0);\r\n        // const actionLeft = cc.moveBy(0.1, cc.v2(-5, 0));\r\n        // const actionRight = cc.moveBy(0.1, cc.v2(10, 0));\r\n        // const actionLeftSecond = cc.moveBy(0.1, cc.v2(-10, 0));\r\n        // const actionRightSecond = cc.moveBy(0.1, cc.v2(5, 0));\r\n        // actionLeft, actionRight, actionLeftSecond, actionRightSecond,\r\n        const actionhiddenoff = cc.fadeTo(0.05,255);\r\n        const actionhiddenSmoll = cc.scaleTo(0.2,1,1);//变大还原\r\n        // cc.spwan( 同时完成\r\n        return new Promise(resolve => {\r\n            node.runAction(\r\n                cc.sequence(actionhiddenBig,actionhiddenOn,actionhiddenoff,actionhiddenSmoll,\r\n                // 执行动作完成之后调用的方法\r\n                cc.callFunc(() => {\r\n                    // cc.log(node);\r\n                    // cc.log(biology);\r\n                    //先走提示再动作\r\n                    // _this.schedule(function(){\r\n                    getFightingExtend.playTips(node,biology)\r\n                    getFightingExtend.playAction(node,biology)\r\n                    // },1)\r\n                    resolve();\r\n                }) )\r\n            );\r\n        });\r\n    },\r\n    //移动\r\n    buttonMove(waite_time,node,m_node,biology) {\r\n      var arr =[];\r\n      var _this =this;\r\n      var m_x=10\r\n      var m_y=0\r\n      var m_x_move =0\r\n      if (node.is_my==1){\r\n        m_x_move =-120\r\n      }else{\r\n        m_x_move =120\r\n      }    \r\n      if (node.x != m_node.x) m_x = m_node.x - node.x+m_x_move\r\n      if (node.y != m_node.y) m_y = m_node.y - node.y \r\n      //普通攻击\r\n      const actionLeft = cc.spawn(cc.moveBy(0.3,cc.v2(m_x,m_y)),cc.scaleTo(0.1, 1, 1.2),cc.callFunc(function(){\r\n              // //等待攻击完成\r\n              // _this.buttonShake(waite_time,m_node,biology)\r\n      },this)) \r\n      // const actionWaite = cc.delayTime(0.01) \r\n      //返回位置\r\n      const actionRight =cc.spawn(cc.moveBy(0.3,cc.v2(-m_x,-m_y)),cc.scaleTo(0.1, 1, 1),cc.callFunc(function(){\r\n          //等待攻击完成\r\n          _this.buttonShake(waite_time,m_node,biology)\r\n      },this))\r\n      // 让节点在向上移动的同时缩放\r\n      // arr.push(cc.scaleTo(0.1, 1,1))\r\n      return new Promise(resolve => {\r\n          node.runAction(\r\n              cc.sequence(actionLeft,actionRight,cc.callFunc(() => {       \r\n                resolve();\r\n              }))\r\n          );\r\n      });\r\n  },\r\n  //受击\r\n  buttonShake(waite_time,node,biology) {\r\n    var _this =this;\r\n    var waite_time=waite_time||0\r\n    const actionWaite =cc.delayTime(waite_time);//等待攻击时间\r\n    const actionhiddenOn = cc.fadeTo(0.05,0);\r\n    const actionLeft = cc.moveBy(0.1, cc.v2(-5, 0));\r\n    const actionRight = cc.moveBy(0.1, cc.v2(10, 0));\r\n    const actionLeftSecond = cc.moveBy(0.1, cc.v2(-10, 0));\r\n    const actionRightSecond = cc.moveBy(0.1, cc.v2(5, 0));\r\n    const actionhiddenoff = cc.fadeTo(0.05,255);\r\n    // cc.spwan( 同时完成\r\n    return new Promise(resolve => {\r\n        node.runAction(\r\n            cc.sequence(actionWaite,actionLeft, actionRight, actionLeftSecond, actionRightSecond,actionhiddenOn,actionhiddenoff,\r\n            // 执行动作完成之后调用的方法\r\n                cc.callFunc(() => {\r\n                    // cc.log(node);\r\n                    // cc.log(biology);\r\n                    // _this.schedule(function(){\r\n                    getFightingExtend.playAction(node,biology)\r\n                    // },1)\r\n                    resolve();\r\n                }) )\r\n        );\r\n    });\r\n},\r\n    //生物渐隐-淡出-淡入\r\n    // nodefadeIn(time,type,node){\r\n    //   // cc.log(node)\r\n    //   var fin_arr=[];\r\n    //   if(type==0){\r\n    //     //先让透明度为0\r\n    //     node.getChildByName('扣血s').opacity=0\r\n    //     fin_arr.push(cc.fadeIn(time));\r\n    //   }else{\r\n    //     //先让透明度为255\r\n    //     node.getChildByName('扣血s').opacity=255\r\n    //     fin_arr.push(cc.fadeOut(time));\r\n    //   }\r\n    //   fin_arr.push(cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n    //     node.getChildByName('扣血s').active=false\r\n    //   },this)) )\r\n    //   node.getChildByName('扣血s').runAction(fin_arr);\r\n    // },\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          this.toolsArray.forEach(element => {\r\n              element.removeFromParent();\r\n          });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    reloadWord(){\r\n      var _this =this;\r\n      httpRequest.httpPost('/app/app-apiword/map-word', params, function (data) {\r\n        //写入地图数据\r\n        _this.addWordMap(data)\r\n        })\r\n    },\r\n    back_map(){\r\n      //移除节点\r\n      var _this = this;\r\n      _this.content.removeAllChildren();\r\n      _this.content.destroyAllChildren();\r\n      httpRequest.playGame(httpRequest.urlConfig(\"sence_ditu\"));\r\n    },\r\n    back_reload(){\r\n      //移除节点\r\n      var _this = this;\r\n      _this.content.removeAllChildren();\r\n      _this.content.destroyAllChildren();\r\n      // this.parent.active=false\r\n      httpRequest.playGame(httpRequest.urlConfig(\"sence_zhandou\"));\r\n    },\r\n    back_home(){\r\n      //移除节点\r\n      var _this = this;\r\n      _this.content.removeAllChildren();\r\n      _this.content.destroyAllChildren();\r\n      httpRequest.playGame(httpRequest.urlConfig(\"sence_dating\"));\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n \r\n});\r\n"]}
{"version":3,"sources":["assets\\Script\\战斗\\score_fighting.js"],"names":["require","cc","Class","Component","properties","toolsArray","fightingArray","home","Node","back_time","init","director","getScene","onLoad","http_globalData","BoxPrefab_content","find","sys","httpRequestBagApi","http_music","httpRequestModel","model_biology_fightingBiology","model_biology_fightingDetail","model_biology_SkillIcon","model_biology_SkillTips","model_biology_fightingEnd","http_user_info","spawnTools","fightingEnd","playTask","goPlay","httpRequestFightingExtend","alertBoat","fighting_boat","start","update","dt","Promise","resolve","getComponent","Label","string","user_info","beishu","_this","figthing_remote_url","localStorage","getItem","httpRequest","playGame","remoteUrl","httpUrlJson","loader","load","url","err","data","fighting","unscheduleAllCallbacks","biolgy_state","poition_my","poition_enemy","BoxPrefab","biology_detail_list","length","fighting_list","boat_length","fighting_history","history_count","boat","boat_count","bpage","total","parseInt","fighting_historyWait","fighting_historyGo","fighting_historyDo","alertResult","onButtonClicked","event","active","his_log","h_yubei","readySkill","h_go","playSkill","h_need","needSkill","h_do","h_putong","playFight","TipBoxPrefab","poition_winner","getChildByName","addChild","addMapPic","map_pic","httpUrl","texture","Sprite","spriteFrame","SpriteFrame","his_log_extend","npage","biology","_this_hero_node","goid","_targ_hero_node","doid","buttonReady","buttonSkill","playAction","buttonMove","bagBtn","gridLayout","parent","forEach","element","removeFromParent","hp_update","node","hp","fill","all_hp","hp_now","fillstart","act_shan","sequence","fadeTo","runAction","repeat","reloadWord","httpPost","addWordMap","back_map","removeBoxprefab","back_reload","back_home","addTouchEvent","node_1","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd"],"mappings":"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","sourceRoot":"/","sourcesContent":["require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n      // 根据TOOLS生成相应的道具\r\n      toolsArray:[],\r\n      fightingArray:[],   \r\n      // content: cc.Node,\r\n      // person: cc.Prefab,\r\n      home: cc.Node,\r\n      // back: cc.Node,\r\n      back_time: cc.Node, //跳过回合\r\n      // //列表\r\n      // test_scrollView: {\r\n      //   default: null,\r\n      //   type: cc.ScrollView\r\n      // },\r\n      // //翻页容器\r\n      // test_pageView: {\r\n      //   default: null,\r\n      //   type: cc.PageView\r\n      // },\r\n\r\n    },\r\n    init(){\r\n      cc.director.getScene();//获取当前场景\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    async onLoad () {\r\n      //全局定义容器节点\r\n      http_globalData.BoxPrefab_content= cc.find('Canvas/大厅/content');\r\n      cc.sys.fightingArray=[]\r\n      cc.sys.toolsArray=[]\r\n      await httpRequestBagApi.http_music()\r\n      await httpRequestModel.model_biology_fightingBiology() //加载模型\r\n      await httpRequestModel.model_biology_fightingDetail();//加载战斗生物详情\r\n      await httpRequestModel.model_biology_SkillIcon();//加载战斗技能图标\r\n      await httpRequestModel.model_biology_SkillTips();//加载战斗技能提示\r\n      await httpRequestModel.model_biology_fightingEnd();//加载战斗结果\r\n\r\n      // this.spawnTools()\r\n      await httpRequestBagApi.http_user_info()\r\n      await this.spawnTools() //加载数据\r\n      await this.fightingEnd() //加载结果\r\n      await this.playTask()\r\n    },\r\n    //task\r\n    async playTask(){\r\n      await this.goPlay() //实例化对象\r\n \r\n      await httpRequestFightingExtend.alertBoat('准备回合') //准备回合\r\n      await this.fighting_boat() //开启回合战斗\r\n\t  },\r\n\r\n\r\n    start () {\r\n    },\r\n    update (dt) {\r\n      // console.log(3333)\r\n    },\r\n    spawnTools () {\r\n      return new Promise(resolve => {\r\n      //开启倍数\r\n      cc.find('Canvas/倍数/倍数s').getComponent(cc.Label).string = http_globalData.user_info.beishu;\r\n      var _this =this;\r\n      var figthing_remote_url = cc.sys.localStorage.getItem('figthing_remote_url'); //读取数据--战斗记录\r\n\r\n      if(figthing_remote_url==null){\r\n          httpRequest.playGame(\"sence_ditu\")\r\n          resolve(); \r\n      }else{\r\n        var remoteUrl = httpRequest.httpUrlJson(figthing_remote_url);\r\n        cc.loader.load({ url: remoteUrl }, function (err, data) {\r\n          //定义常量\r\n          http_globalData.fighting = data;\r\n          //开启战斗\r\n          resolve(); \r\n          //  await   _this.goPlay( )\r\n        });    \r\n      }\r\n      })\r\n    },\r\n\r\n    //开启战斗--加载生物\r\n    async goPlay( ){\r\n      // return new Promise(resolve => {\r\n        //播放器先清除所有定时器\r\n        this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n        let data = http_globalData.fighting\r\n        // cc.log(data)\r\n        var biolgy_state = data.data.biolgy_state;\r\n        var poition_my = data.data.poition_my;\r\n        var poition_enemy = data.data.poition_enemy;\r\n        //生物挂载\r\n        var BoxPrefab = http_globalData.BoxPrefab_content\r\n        await BoxPrefab.getComponent('fightingTools').biology_detail_list(BoxPrefab,poition_my,biolgy_state,1,0) //挂载生物--position_my\r\n        await BoxPrefab.getComponent('fightingTools').biology_detail_list(BoxPrefab,poition_enemy,biolgy_state,0,poition_my.length) //挂载生物--position_ememy\r\n\r\n        // await this.biology_detail_list(BoxPrefab,poition_my,biolgy_state,1,0) //挂载生物--position_my\r\n        // await this.biology_detail_list(BoxPrefab,poition_enemy,biolgy_state,0,poition_my.length) //挂载生物--position_ememy\r\n      // _this.addMapPic(data) //生成地图\r\n      // console.log( _this.toolsArray)\r\n      // console.log( cc.sys.fightingArray )\r\n        // resolve();})\r\n    },\r\n    // 战斗回合\r\n    async fighting_boat(){\r\n      var _this =this;\r\n      // return new Promise(resolve => {\r\n      var fighting_list =  http_globalData.fighting.data;    \r\n      var boat_length = fighting_list.fighting_history.length\r\n      var history_count =  fighting_list.history_count\r\n      var fighting_history= fighting_list.fighting_history;\r\n      if(boat_length!=0){\r\n        var boat=0;\r\n        var boat_count=-1;\r\n        //一条或多条执行语句\r\n        // _this.schedule(function(){\r\n        //循环历史行动条数\r\n        for (var bpage=0; bpage<boat_length; bpage++){\r\n        // _this.schedule(function(){\r\n            boat_count++\r\n            if(history_count[boat].total<boat_count){\r\n              boat++;\r\n            }\r\n            await httpRequestFightingExtend.alertBoat('第'+ parseInt(boat+1)+'回合')\r\n            //判断下动作是否已经下一回合\r\n            // if(cc.find('Canvas/大厅/time').getComponent(cc.Label).string!='第'+ parseInt(boat+1)+'回合' ){\r\n            //   await this.alertBoat('第'+ parseInt(boat+1)+'回合')\r\n            //   // cc.find('Canvas/大厅/time').getComponent(cc.Label).string = '第'+ parseInt(boat+1)+'回合'                    \r\n            //   // return new Promise(resolve => {  cc.find('Canvas/大厅/time').runAction(   cc.sequence(cc.scaleTo(0.2, 2, 2),cc.scaleTo(0.2, 1,1),cc.callFunc(function(){   resolve()},this)));//建一个缩放到1.5倍大小的动作，持续时间2秒\r\n            //   //  }) \r\n            // }\r\n            // cc.log(fighting_history[boat_count])\r\n            //如果是空回合 ，等待跳过\r\n            if(fighting_history[boat_count]){\r\n              // cc.log(fighting_history[boat_count])\r\n              await   _this.fighting_historyWait(fighting_history[boat_count])//执行战斗等待回合\r\n              await   _this.fighting_historyGo(fighting_history[boat_count])//执行被动\r\n              await   _this.fighting_historyDo(fighting_history[boat_count])//执行技能 \r\n              await   _this.fighting_history(fighting_history[boat_count])//普通   \r\n            } \r\n              // 绑定点击事件\r\n              // _this.back_time.on('click', _this.onButtonClicked,this);    \r\n             \r\n        // },1,boat_length,1.5);////2秒后执行1次间隔5秒\r\n          }\r\n      }\r\n      return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // resolve();})\r\n    },\r\n \r\n    //暂停并且跳过回合\r\n    onButtonClicked: function(event) {\r\n      // return new Promise(resolve => {    _this.alertResult();  resolve()  })\r\n      // 跳过回合\r\n      // var _this =this\r\n      // _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n      //   cc.log('跳过')\r\n    },\r\n\r\n    alertResult(){\r\n      var _this =this;\r\n      cc.find('Canvas/结算').active =true;// 结束弹窗结果\r\n      // _this.unschedule();\r\n      _this.unscheduleAllCallbacks();//停止某组件的所有计时器\r\n    },\r\n    //预备回合\r\n    async fighting_historyWait(his_log){\r\n      var _this = this;\r\n        if(his_log.h_yubei.length!=0){\r\n          await  _this.readySkill(his_log.h_yubei)\r\n          // cc.log('预备回合')\r\n        }\r\n    },\r\n    //发起被动\r\n    async fighting_historyGo(his_log) {\r\n       var _this =this;\r\n        if(his_log.h_go.length!=0){\r\n            //消耗魔法 --技能名称和消耗放一起了\r\n            await   _this.playSkill(his_log.h_go)\r\n            if(his_log.h_need.length!=0){\r\n              await  _this.needSkill(his_log.h_need)\r\n            }\r\n\r\n        }\r\n    },\r\n    //发起技能\r\n    async fighting_historyDo (his_log) {\r\n      var _this =this;\r\n          if(his_log.h_do.length!=0){\r\n              //消耗魔法 --技能名称和消耗放一起了\r\n              await   _this.playSkill(his_log.h_do)\r\n              if(his_log.h_need.length!=0){\r\n                await  _this.needSkill(his_log.h_need)\r\n              }\r\n    \r\n          }\r\n      },\r\n    //战斗回合\r\n    async fighting_history(his_log) {\r\n      // return new Promise(resolve => {\r\n        var _this = this;\r\n        //回合结束\r\n        // if(his_log.h_end.length!=0){\r\n        //   cc.log('回合结束')\r\n        // }\r\n        // cc.log(his_log)\r\n\r\n        //反击\r\n        // if(his_log.h_back.length!=0){\r\n        //   _this.playFight(_this_hero_node,_targ_hero_node,biology,his_log.h_back)\r\n        // }\r\n        //普通攻击\r\n        if(his_log.h_putong.length!=0){\r\n          await     _this.playFight(his_log.h_putong)\r\n        }\r\n    },\r\n      //战斗结束\r\n   async fightingEnd() {\r\n        // var _this =this;\r\n        var fighting_list =  http_globalData.fighting.data; \r\n        return new Promise(resolve => { \r\n            //开始实例化预制资源\r\n            var TipBoxPrefab = http_globalData.model_biology_fightingEnd\r\n            // TipBoxPrefab.getComponent('fightingTools').initInfo(fighting_list); //写入奖励物品预制体\r\n            if(fighting_list.poition_winner==1){\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='胜利！';\r\n            }else{\r\n              TipBoxPrefab.getChildByName('结果s').getComponent(cc.Label).string='失败！';\r\n            }\r\n            //将预制资源添加到父节点\r\n            cc.find('Canvas/结算/弹框').addChild(TipBoxPrefab,this);\r\n            resolve()\r\n        }) \r\n    },\r\n\r\n    //生成地图\r\n    addMapPic(data){\r\n        var _this = this;\r\n        var  map_pic =data.data['map_pic'];\r\n        var remoteUrl = httpRequest.httpUrl(map_pic);\r\n        // console.log(remoteUrl)\r\n        cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n          if(texture!=null){\r\n          _this.home.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n          }\r\n        });\r\n    },\r\n \r\n    //技能准备动作\r\n    async  readySkill(his_log_extend){\r\n      // return new Promise(resolve => {\r\n        if(his_log_extend.length!=0){\r\n          var _this =this\r\n          for (var npage=0; npage<his_log_extend.length; npage++){\r\n            var biology = his_log_extend[npage];\r\n            var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n            var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,1)\r\n            }\r\n        } \r\n      // resolve();})\r\n    },\r\n    //技能消耗动作\r\n    async needSkill(his_log_extend){\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          // _this.buttonShake(0.5,_targ_hero_node,biology)//技能攻击\r\n          // _this.schedule(function(){\r\n            await httpRequestFightingExtend.buttonSkill(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n          // },1)\r\n        }\r\n      }\r\n    },\r\n    //技能攻击动作\r\n    async playSkill(his_log_extend){\r\n     \r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          \r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          //2个攻击类型只能二选一 \r\n          // _this.buttonShake(0.1,_targ_hero_node,biology)//技能攻击，动作后伤害\r\n          await httpRequestFightingExtend.playAction(_targ_hero_node,biology,1) //不需要其它动作，瞬发伤害动作\r\n  \r\n        }\r\n      }\r\n \r\n    },\r\n    //普通攻击动作\r\n    async  playFight(his_log_extend){\r\n      // return new Promise(resolve => {\r\n      if(his_log_extend.length!=0){\r\n        var _this =this\r\n        for (var npage=0; npage<his_log_extend.length; npage++){\r\n          var biology = his_log_extend[npage];\r\n          // cc.log(cc.sys.fightingArray)\r\n          var _this_hero_node =cc.sys.fightingArray[biology.goid]\r\n          var _targ_hero_node =cc.sys.fightingArray[biology.doid]\r\n          if(biology.goid==biology.doid){\r\n              // _this.buttonShake(0,_targ_hero_node,biology)//自己闪动\r\n            await httpRequestFightingExtend.buttonReady(_this_hero_node,biology,0)//自己变大--加载技能动作\r\n            // await httpRequestFightingExtend.playAction(_this_hero_node,biology,0)\r\n          }else{\r\n            await httpRequestFightingExtend.buttonMove(_this_hero_node,_targ_hero_node,biology,0) //移动\r\n            // await httpRequestFightingExtend.playAction(_targ_hero_node,biology,0)\r\n          }\r\n        }\r\n      }\r\n    // resolve();})\r\n    },\r\n\r\n    //生物渐隐-淡出-淡入\r\n    // nodefadeIn(time,type,node){\r\n    //   // cc.log(node)\r\n    //   var fin_arr=[];\r\n    //   if(type==0){\r\n    //     //先让透明度为0\r\n    //     node.getChildByName('扣血s').opacity=0\r\n    //     fin_arr.push(cc.fadeIn(time));\r\n    //   }else{\r\n    //     //先让透明度为255\r\n    //     node.getChildByName('扣血s').opacity=255\r\n    //     fin_arr.push(cc.fadeOut(time));\r\n    //   }\r\n    //   fin_arr.push(cc.spawn(cc.delayTime(0.5),cc.callFunc(function(){\r\n    //     node.getChildByName('扣血s').active=false\r\n    //   },this)) )\r\n    //   node.getChildByName('扣血s').runAction(fin_arr);\r\n    // },\r\n    bagBtn () {\r\n      // 背包按钮\r\n      if (this.gridLayout.parent.active) {\r\n          // 隐藏节点\r\n          this.gridLayout.parent.active = false;\r\n\r\n          // 删除所有道具(或者不删，只是隐藏，自己决定)\r\n          // this.toolsArray.forEach(element => {\r\n          //     element.removeFromParent();\r\n          // });\r\n          cc.sys.toolsArray.forEach(element => {\r\n                element.removeFromParent();\r\n            });\r\n      }\r\n      else {\r\n          // 显示节点\r\n          this.gridLayout.parent.active = true;\r\n\r\n          // 生成所有道具\r\n          this.spawnTools();\r\n      }\r\n    },\r\n    // 刷新血条\r\n    hp_update(node){\r\n      //受到15伤害\r\n      this.hp -= 15;\r\n      // 求出伤害血量占比并显示\r\n      let fill = this.hp /this.all_hp;\r\n      this.hp_now.fillstart = 1 - fill; \r\n\r\n      // 血条延迟，秒执行一次，一共执行六次，延迟为0\r\n      // this.schedule(function(){\r\n      //     this.magnetnumber-=5/8;\r\n      // },1,6,0);\r\n\r\n      //0.5秒内闪烁\r\n      let act_shan = cc.sequence(cc .fadeTo(0.05,0),cc.fadeTo(0.05,255));\r\n      element.runAction(cc.repeat(act_shan,5));\r\n      // //0.5秒后还可以被攻击\r\n      //   this.scheduleOnce(function() {\r\n      //     this.state = 0;\r\n      //   }.bind(this),0.5);\r\n    },\r\n    reloadWord(){\r\n      var _this =this;\r\n      httpRequest.httpPost('/app/app-apiword/map-word',{}, function (data) {\r\n        //写入地图数据\r\n        _this.addWordMap(data)\r\n        })\r\n    },\r\n    back_map(){\r\n      //移除节点\r\n      // var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      httpRequest.playGame(\"sence_ditu\")\r\n    },\r\n    //重播\r\n    back_reload(){\r\n      //移除节点\r\n      var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      _this.playTask( )\r\n      cc.find('Canvas/结算').active =false;// 结束弹窗结果\r\n    },\r\n    back_home(){\r\n      //移除节点\r\n      // var _this = this;\r\n      httpRequestModel.removeBoxprefab()\r\n      httpRequest.playGame(\"sence_dating\")\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n \r\n    // onDestroy() {\r\n    //     // 停止定时器\r\n    //     this.unschedule(this.fighting_history);\r\n    // }\r\n\r\n \r\n});\r\n"]}
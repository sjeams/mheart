{"version":3,"sources":["assets\\Script\\阵法\\bag_zhengfa头像Tools.js"],"names":["HttpHelper","require","httpRequest","cc","Class","Component","biology_detail_list","TipBoxPrefab_model","TipBoxPrefab","biology","_this","loader","loadRes","errorMessage","loadedResource_icon","num_height","info","prop","TipBoxPrefab_icon","instantiate","image","picture","SpriteFrame","err","texture","getChildByName","getComponent","Sprite","spriteFrame","Label","string","name","bind_button_detail","is_bag","active","find","addChild","scorllheight","parent","line_hight","Math","ceil","cellHeight","height","setContentSize","bind_button_page","on","new_page","parseInt","page","page_size","scorll_page","y","total_page","new_prefab","isDragging","Node","EventType","TOUCH_START","event","startPos","getLocation","position","log","TOUCH_MOVE","touchEvent","location","convertToNodeSpaceAR","children","forEach","targetNode","rect","getBoundingBox","point","contains","biology_id","indexOf","zhenfa_id","console","TOUCH_END"],"mappings":"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","sourceRoot":"/","sourcesContent":["var HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\ncc.Class({\r\n    extends: cc.Component,\r\n     //技能图片渲染\r\n    //  biology_detail_alert(TipBoxPrefab_model){\r\n    //     var info_list = cc.globalData.biology\r\n    //     //加载背包 和  背包列表\r\n    //     // let biology = cc.globalData.biology\r\n    //     // let gooduse_type_name = cc.globalData.gooduse;\r\n    //     // gooduse_type  1武器\r\n    //     // var gooduse_type=gooduse_type||1;\r\n    //     var _this=this;\r\n    //     cc.loader.loadRes('/model布阵/背包生物', function(errorMessage,loadedResource_icon){\r\n    //         //开始实例化预制资源\r\n    //         let   TipBoxPrefab =  cc.instantiate(loadedResource_icon);\r\n    //         //技能等级\r\n    //         // TipBoxPrefab.getChildByName('生物数量s').getComponent(cc.Label).string='生物('+info_list.length+'/60)'\r\n    //         // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n            \r\n    //         //修改背包标题-----弹窗的标题修改\r\n    //         // TipBoxPrefab.getChildByName('标题s').getComponent(cc.Label).string=gooduse_type_name[gooduse_type].name\r\n\r\n    //         // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n    //         _this.biology_detail_list(TipBoxPrefab_model,TipBoxPrefab,info_list) \r\n    //            // 此处进行事件绑定\r\n    //         // _this.bind_button(TipBoxPrefab_model,TipBoxPrefab)\r\n    //         //写入icon\r\n    //         TipBoxPrefab_model.getChildByName('生物头像').addChild(TipBoxPrefab);\r\n    //     })\r\n    // },\r\n    //list渲染\r\n    biology_detail_list(TipBoxPrefab_model,TipBoxPrefab,biology){\r\n\r\n        //获取点击物品的类型\r\n        var _this =this;\r\n        //加载预制资源 PrefabUrl为 预制资源在 资源中的路径\r\n        cc.loader.loadRes('/model布阵/图标生物', function(errorMessage,loadedResource_icon){\r\n            var num_height=0;\r\n            for ( var prop in biology) {\r\n                let info = biology[prop];\r\n                //1是武器\r\n                // if(info.gooduse==gooduse_type){\r\n                    var num_height =num_height+1\r\n                    // //开始实例化预制资源\r\n                    let   TipBoxPrefab_icon =  cc.instantiate(loadedResource_icon);\r\n                    // //载入技能图片\r\n                    let image = info.picture;\r\n                    cc.loader.loadRes(image, cc.SpriteFrame, function (err, texture) { \r\n                        if (err) {\r\n                            // cc.error(err.message || err);\r\n                            return;\r\n                        }\r\n                        TipBoxPrefab_icon.getChildByName('P技能').getComponent(cc.Sprite).spriteFrame = texture; \r\n                        TipBoxPrefab_icon.getChildByName('P移动').getComponent(cc.Sprite).spriteFrame = texture; \r\n                    });\r\n                    // //技能等级\r\n                    TipBoxPrefab_icon.getChildByName('技能s').getComponent(cc.Label).string=info.name        \r\n                    // // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n                    //重新挂载\r\n                    _this.bind_button_detail(TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon)\r\n                    // //写入icon\r\n                    // TipBoxPrefab.getChildByName('技能列表').addChild(TipBoxPrefab_icon);\r\n                    //隐藏已经使用的装备\r\n                    if(info.is_bag==1){\r\n                        TipBoxPrefab_icon.active=false\r\n                    }\r\n                    //写入icon\r\n                    cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).addChild(TipBoxPrefab_icon);\r\n                }\r\n            // }\r\n    \r\n            // 定义content滚动条高度\r\n            let scorllheight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).parent;\r\n            //滚动高度= 预制体100*个数+ 上下 预留10 的位置  \r\n            //列个数--进1取整\r\n            let line_hight =Math.ceil(num_height/3)\r\n            let cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).height * 0.25+10;\r\n            var height =  cellHeight*(line_hight )\r\n            if(height<=420){\r\n                var height = 420\r\n            }\r\n            //设置滚动条高度\r\n            scorllheight.setContentSize(500,height)\r\n\r\n            TipBoxPrefab.getChildByName('总数s').getComponent(cc.Label).string =Math.ceil(num_height/12)\r\n            // 此处进行事件绑定\r\n            _this.bind_button_page(TipBoxPrefab)\r\n        })\r\n\r\n   \r\n        return TipBoxPrefab\r\n    },\r\n    //分页\r\n    bind_button_page(TipBoxPrefab_icon){\r\n        TipBoxPrefab_icon.getChildByName('上一页').on('click', function () {\r\n           var new_page = TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string\r\n           var new_page = parseInt(new_page)\r\n            if(new_page>1){\r\n                new_page= parseInt(new_page-1)\r\n                 TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n            //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           var cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n   \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab_icon.getComponent(cc.ScrollView)\r\n           cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).parent.y = scorll_page; // 水平居中\r\n        }, this);\r\n        TipBoxPrefab_icon.getChildByName('下一页').on('click', function () {\r\n            var total_page = TipBoxPrefab_icon.getChildByName('总数s').getComponent(cc.Label).string\r\n            var total_page = parseInt(total_page)\r\n            var new_page = TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string\r\n            var new_page = parseInt(new_page)\r\n            if(new_page<total_page){\r\n                new_page= parseInt(new_page+1)\r\n                TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n           //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           var cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n         \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab_icon.getComponent(cc.ScrollView)\r\n           cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).parent.y = scorll_page; // 水平居中\r\n\r\n        }, this);\r\n\r\n    },\r\n    //绑定点击事件--关闭遮罩\r\n    // bind_button(TipBoxPrefab_model,TipBoxPrefab_icon){\r\n    //     TipBoxPrefab_icon.getChildByName('遮罩').on('click', function () {\r\n    //         // 事件处理逻辑\r\n    //         //移除挂载\r\n    //         TipBoxPrefab_model.getChildByName('左边弹窗').removeAllChildren();\r\n\r\n    //     }, this);\r\n\r\n    // },\r\n    //绑定点击事件--alert详情\r\n    bind_button_detail(TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon){\r\n\r\n        // TipBoxPrefab_model.getChildByName('生物移动').getComponent(cc.Sprite).spriteFrame =  TipBoxPrefab_icon.getChildByName('P技能').getComponent(cc.Sprite).spriteFrame  \r\n        var new_prefab = TipBoxPrefab_icon.getChildByName('P移动');\r\n        var isDragging = false;\r\n        // 关闭多点触摸\r\n        // cc.macro.ENABLE_MULTI_TOUCH = false;\r\n        // 开始拖拽\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n            // 记录初始位置\r\n            let startPos = event.getLocation();\r\n            new_prefab.position = startPos;\r\n            cc.log('开始')\r\n            cc.log(isDragging)\r\n            // 标记为正在拖拽\r\n            isDragging = true;\r\n            \r\n        }, TipBoxPrefab_icon);\r\n   // 关闭多点触摸\r\n        // cc.macro.ENABLE_MULTI_TOUCH = false;\r\n         // 拖拽中\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_MOVE,function (touchEvent) {\r\n            if (isDragging) {\r\n                // var delta = touchEvent.touch.getDelta();\r\n                // new_prefab.x += delta.x\r\n                // new_prefab.y += delta.y\r\n                let location = touchEvent.getLocation();\r\n                new_prefab.position = new_prefab.parent.convertToNodeSpaceAR(location); // 确定位置\r\n                TipBoxPrefab.getChildByName('阵法详情').children.forEach((targetNode) => {\r\n                    let rect = targetNode.getBoundingBox();\r\n                    let point = targetNode.parent.convertToNodeSpaceAR(location);\r\n                    // cc.log(point)\r\n                    if (rect.contains(point)) {\r\n                        // 如果在边界矩形内，则被拖拽到了目标节点中\r\n                        // console.log(\"拖拽到了目标节点\");\r\n                        var biology_id = TipBoxPrefab_icon.parent.children.indexOf(TipBoxPrefab_icon); //生物id\r\n                        var zhenfa_id =  targetNode.parent.children.indexOf(targetNode); //阵法id\r\n                        console.log(\"拖拽到了目标节点\"+biology_id);\r\n                        cc.log(isDragging)\r\n                        // var TipBoxPrefab_biology =  TipBoxPrefab.getChildByName('阵法详情').children[biology_id]\r\n                        // TipBoxPrefab_model.getComponent('bag_zhengfa布阵Tools').biology_buzhen_detail(TipBoxPrefab_icon,biology,key)\r\n\r\n                    } else {\r\n                        // 如果不在边界矩形内，则没有被拖拽到目标节点中\r\n                        // console.log(\"没有拖拽到目标节点\");\r\n                        // new_prefab.position = position; // 回去\r\n                    }\r\n                });\r\n        }\r\n        }, TipBoxPrefab_icon)\r\n\r\n        // 松开\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_END, (event) => {\r\n\r\n\r\n            cc.log('松开')\r\n            // 标记为已经松开\r\n            isDragging = false;\r\n\r\n            cc.log(isDragging)\r\n            // 这里可以添加松开后的处理逻辑\r\n        }, TipBoxPrefab_icon);\r\n\r\n        // 取消拖拽（如触摸被系统取消时）\r\n        // TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_CANCEL, (event) => {\r\n        //     if (event.getID() === 0) {\r\n        //     cc.log('取消')\r\n        //     // 标记为已经松开\r\n        //     isDragging = false;\r\n        //     // 这里可以添加取消拖拽后的处理逻辑\r\n        //     }\r\n        // }, TipBoxPrefab_icon);\r\n    }\r\n});\r\n\r\n\r\n"]}
{"version":3,"sources":["assets\\Script\\阵法\\bag_zhenfa头像Tools.js"],"names":["HttpHelper","require","httpRequest","cc","Class","Component","biology_detail_list","TipBoxPrefab_model","TipBoxPrefab","_this","loader","loadRes","errorMessage","loadedResource_icon","num_height","info","globalData","biology","prop","TipBoxPrefab_icon","instantiate","image","picture","SpriteFrame","err","texture","getChildByName","getComponent","Sprite","spriteFrame","bind_button_detail","Label","string","name","is_chuzhan","active","find","addChild","scorllheight","parent","line_hight","Math","ceil","cellHeight","height","setContentSize","bind_button_page","on","new_page","parseInt","page","page_size","scorll_page","y","total_page","new_prefab","isDragging","startPos","position","Node","EventType","TOUCH_START","event","TOUCH_MOVE","location","getLocation","convertToNodeSpaceAR","children","forEach","targetNode","rect","getBoundingBox","point","zhenfa_id","indexOf","TipBoxPrefab_icon_new","contains","color","TOUCH_END","TOUCH_CANCEL","movingInt","biology_id","isInArray","zhenfa","includes","zhenfa_index","TipBoxPrefab_icon_remove","biologyClickRemove","biology_detail_tips","biology_buzhen_detail","log"],"mappings":"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","sourceRoot":"/","sourcesContent":["var HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\ncc.Class({\r\n    extends: cc.Component,\r\n    //list渲染\r\n    biology_detail_list(TipBoxPrefab_model,TipBoxPrefab){\r\n\r\n        //获取点击物品的类型\r\n        var _this =this;\r\n        //加载预制资源 PrefabUrl为 预制资源在 资源中的路径\r\n        cc.loader.loadRes('/model布阵/图标生物', function(errorMessage,loadedResource_icon){\r\n            var num_height=0;\r\n            for ( var prop in cc.globalData.biology) {\r\n                let info = cc.globalData.biology[prop];\r\n                //1是武器\r\n                // if(info.gooduse==gooduse_type){\r\n                    var num_height =num_height+1\r\n                    // //开始实例化预制资源\r\n                    let   TipBoxPrefab_icon =  cc.instantiate(loadedResource_icon);\r\n                    // //载入技能图片\r\n                    let image = info.picture;\r\n                    cc.loader.loadRes(image, cc.SpriteFrame, function (err, texture) { \r\n                        if (err) {\r\n                            // cc.error(err.message || err);\r\n                            return;\r\n                        }\r\n                        TipBoxPrefab_icon.getChildByName('P技能').getComponent(cc.Sprite).spriteFrame = texture; \r\n                        // TipBoxPrefab_icon.getChildByName('P移动').getComponent(cc.Sprite).spriteFrame = texture; \r\n                        //拖拽\r\n                        _this.bind_button_detail(TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon,texture)\r\n                    });\r\n                    // //技能等级\r\n                    TipBoxPrefab_icon.getChildByName('技能s').getComponent(cc.Label).string=info.name        \r\n                    // // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n                    //判断是否出战\r\n                    if(info.is_chuzhan){\r\n                        TipBoxPrefab_icon.getChildByName('P出战').active=true\r\n                    }else{\r\n                        TipBoxPrefab_icon.getChildByName('P出战').active=false\r\n                    }\r\n                    //写入icon\r\n                    cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).addChild(TipBoxPrefab_icon);\r\n                }\r\n            // }\r\n    \r\n            // 定义content滚动条高度\r\n            let scorllheight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).parent;\r\n            //滚动高度= 预制体100*个数+ 上下 预留10 的位置  \r\n            //列个数--进1取整\r\n            let line_hight =Math.ceil(num_height/3)\r\n            let cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab).height * 0.25+10;\r\n            var height =  cellHeight*(line_hight )\r\n            if(height<=420){\r\n                var height = 420\r\n            }\r\n            //设置滚动条高度\r\n            scorllheight.setContentSize(500,height)\r\n\r\n            TipBoxPrefab.getChildByName('总数s').getComponent(cc.Label).string =Math.ceil(num_height/12)\r\n            // 此处进行事件绑定\r\n            _this.bind_button_page(TipBoxPrefab)\r\n        })\r\n\r\n   \r\n        return TipBoxPrefab\r\n    },\r\n    //分页\r\n    bind_button_page(TipBoxPrefab_icon){\r\n        TipBoxPrefab_icon.getChildByName('上一页').on('click', function () {\r\n           var new_page = TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string\r\n           var new_page = parseInt(new_page)\r\n            if(new_page>1){\r\n                new_page= parseInt(new_page-1)\r\n                 TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n            //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           var cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n   \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab_icon.getComponent(cc.ScrollView)\r\n           cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).parent.y = scorll_page; // 水平居中\r\n        }, this);\r\n        TipBoxPrefab_icon.getChildByName('下一页').on('click', function () {\r\n            var total_page = TipBoxPrefab_icon.getChildByName('总数s').getComponent(cc.Label).string\r\n            var total_page = parseInt(total_page)\r\n            var new_page = TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string\r\n            var new_page = parseInt(new_page)\r\n            if(new_page<total_page){\r\n                new_page= parseInt(new_page+1)\r\n                TipBoxPrefab_icon.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n           //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           var cellHeight =  cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n         \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab_icon.getComponent(cc.ScrollView)\r\n           cc.find(\"content/列表/content/gridLayout\",TipBoxPrefab_icon).parent.y = scorll_page; // 水平居中\r\n\r\n        }, this);\r\n\r\n    },\r\n    //绑定点击事件--关闭遮罩\r\n    // bind_button(TipBoxPrefab_model,TipBoxPrefab_icon){\r\n    //     TipBoxPrefab_icon.getChildByName('遮罩').on('click', function () {\r\n    //         // 事件处理逻辑\r\n    //         //移除挂载\r\n    //         TipBoxPrefab_model.getChildByName('左边弹窗').removeAllChildren();\r\n\r\n    //     }, this);\r\n    // },\r\n    //绑定点击事件--alert详情\r\n    bind_button_detail(TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon,texture){\r\n        var _this =this;\r\n        var new_prefab =  TipBoxPrefab.getChildByName('生物移动')\r\n        var isDragging = false;\r\n        var startPos =  TipBoxPrefab_icon.position;\r\n        // 关闭多点触摸\r\n        // cc.macro.ENABLE_MULTI_TOUCH = false;\r\n        // 开始拖拽\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n            // new_prefab.position = startPos;\r\n            TipBoxPrefab.getChildByName('生物移动').position=startPos;\r\n            TipBoxPrefab.getChildByName('生物移动').getComponent(cc.Sprite).spriteFrame =  texture \r\n            // 标记为正在拖拽\r\n            isDragging = true;\r\n            \r\n        }, TipBoxPrefab_icon);\r\n         // 拖拽中\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_MOVE,function (event) {\r\n            if (isDragging) {\r\n                // var delta = event.touch.getDelta();\r\n                // new_prefab.x += delta.x\r\n                // new_prefab.y += delta.y\r\n                var location = event.getLocation();\r\n                new_prefab.position = new_prefab.parent.convertToNodeSpaceAR(location); // 确定位置\r\n                TipBoxPrefab.getChildByName('生物移动').active=true;\r\n\r\n                TipBoxPrefab.getChildByName('阵法详情').children.forEach((targetNode) => {\r\n                    var rect = targetNode.getBoundingBox();\r\n                    var location = event.getLocation();\r\n                    var point = targetNode.parent.convertToNodeSpaceAR(location);\r\n                    var zhenfa_id =  targetNode.parent.children.indexOf(targetNode); //阵法id\r\n                    var  TipBoxPrefab_icon_new =    TipBoxPrefab.getChildByName('阵法详情').children[zhenfa_id]\r\n                    if (rect.contains(point)) {\r\n                        TipBoxPrefab_icon_new.getChildByName('生物').color = new cc.color('#3568D5');\r\n                    }else {\r\n                        TipBoxPrefab_icon_new.getChildByName('生物').color = new cc.color('#FFFFFF');\r\n                    }\r\n            });\r\n            }\r\n        }, TipBoxPrefab_icon)\r\n        // 松开\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_END, (event) => {\r\n            TipBoxPrefab.getChildByName('生物移动').active=false\r\n            // 松开\r\n            isDragging = false;\r\n            // 松开不做任何操作\r\n        }, TipBoxPrefab_icon);\r\n        // 取消拖拽（如触摸被系统取消时）\r\n        TipBoxPrefab_icon.on(cc.Node.EventType.TOUCH_CANCEL, (event) => {\r\n            // 取消\r\n            _this.movingInt(event,TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon)\r\n            TipBoxPrefab.getChildByName('生物移动').active=false\r\n            new_prefab.position = startPos;\r\n            isDragging = false;\r\n        }, TipBoxPrefab_icon);\r\n    },\r\n    //移动定位\r\n    movingInt(event,TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon){\r\n        var _this =this;\r\n        TipBoxPrefab.getChildByName('阵法详情').children.forEach((targetNode) => {\r\n            var rect = targetNode.getBoundingBox();\r\n            var location = event.getLocation();\r\n            var point = targetNode.parent.convertToNodeSpaceAR(location);\r\n            //进入范围替换\r\n            if (rect.contains(point)) {\r\n                // 如果在边界矩形内，则被拖拽到了目标节点中\r\n                var biology_id = TipBoxPrefab_icon.parent.children.indexOf(TipBoxPrefab_icon); //生物id biology_id\r\n                var zhenfa_id =  targetNode.parent.children.indexOf(targetNode); //阵法id\r\n\r\n                var TipBoxPrefab_icon_new =   TipBoxPrefab.getChildByName('阵法详情').children[zhenfa_id]\r\n                // 使用includes方法来判断值是否在数组内\r\n                var isInArray = cc.globalData.zhenfa.includes(biology_id);\r\n                //是否在阵法中\r\n                if (isInArray) {\r\n                   //已存在的阵法位置--需要移除\r\n                    var zhenfa_index = cc.globalData.zhenfa.indexOf(biology_id);\r\n                    var TipBoxPrefab_icon_remove = TipBoxPrefab.getChildByName('阵法详情').children[zhenfa_index]\r\n                    // cc.log(isInArray + ' is in the array.');\r\n                    //需要移除已存在的节点\r\n                    TipBoxPrefab_model.getComponent('bag_zhenfa布阵Tools').biologyClickRemove(TipBoxPrefab_model,TipBoxPrefab_icon_remove)\r\n                } else {\r\n                    // cc.log(isInArray + ' is not in the array.');\r\n                    // 直接添加\r\n                }\r\n\r\n                //添加到阵法\r\n                cc.globalData.zhenfa[zhenfa_id] =biology_id\r\n                cc.globalData.biology[biology_id].is_chuzhan=1;\r\n                //操作提示\r\n                TipBoxPrefab_model.getComponent('bag_zhenfaTools').biology_detail_tips(TipBoxPrefab_model,'操作成功!')\r\n                //放入布阵  \r\n                TipBoxPrefab_model.getComponent('bag_zhenfa布阵Tools').biology_buzhen_detail(TipBoxPrefab_model,TipBoxPrefab,TipBoxPrefab_icon_new,zhenfa_id) \r\n                //返回未选择中状态\r\n                TipBoxPrefab_icon_new.getChildByName('生物').color = new cc.color('#FFFFFF')\r\n                cc.log(\"拖拽到了目标节点\"+zhenfa_id);\r\n            } \r\n        });\r\n    },\r\n});\r\n\r\n\r\n"]}
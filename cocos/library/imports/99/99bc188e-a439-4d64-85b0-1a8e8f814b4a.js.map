{"version":3,"sources":["assets\\Script\\login\\register_knows.js"],"names":["HttpHelper","require","httpRequest","cc","Class","Component","properties","register_knows_webview","WebView","onLoad","tokenlogin","token","sys","localStorage","getItem","httpPostLogin","data","_this","code","start","show_dlg","node","active","hidden_dlg","xieyi_show_dlg","webview","find","getComponent","url","xieyi_hidden_dlg","yinsi_show_dlg","yinsi_hidden_dlg"],"mappings":";;;;;;AAAA,IAAIA,UAAU,GAAGC,OAAO,CAAC,SAAD,CAAxB;;AACA,IAAIC,WAAW,GAAG,IAAIF,UAAJ,EAAlB;AACAG,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACR;AACA;AACA;AACAC,IAAAA,sBAAsB,EAACJ,EAAE,CAACK;AAJlB,GAHP;AAULC,EAAAA,MAAM,EAAE,kBAAY,CAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEH,GArCI;AAsCLC,EAAAA,UAAU,EAAE,sBAAU;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA,QAAIC,KAAK,GAAER,EAAE,CAACS,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAX;;AACA,QAAGH,KAAH,EAAS;AACDT,MAAAA,WAAW,CAACa,aAAZ,CAA0B,6BAA1B,EAAyD;AAAC,iBAAQJ;AAAT,OAAzD,EAA0E,UAAUK,IAAV,EAAgB;AACtF,YAAIC,KAAK,GAAE,IAAX,CADsF,CAEtF;AACA;AACA;AACA;AACA;AACA;;;AACA,YAAGD,IAAI,CAACE,IAAL,IAAW,CAAd,EAAgB,CACZ;AACH,SAFD,MAEK,CACA;AACJ;AACR,OAbG;AAeP;AACJ,GAhFI;AAkFL;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAC,EAAAA,KAxLK,mBAwLI,CAER,CA1LI;AA4LL;AAEAC,EAAAA,QA9LK,sBA8LO;AACR,SAAKC,IAAL,CAAUC,MAAV,GAAkB,IAAlB;AACH,GAhMI;AAiMLC,EAAAA,UAjMK,wBAiMS;AACV,SAAKF,IAAL,CAAUC,MAAV,GAAkB,KAAlB;AACH,GAnMI;AAqMLE,EAAAA,cArMK,4BAqMa;AACd;AACA,QAAIC,OAAO,GAAGtB,EAAE,CAACuB,IAAH,CAAQ,yDAAR,EAAmEC,YAAnE,CAAgFxB,EAAE,CAACK,OAAnF,CAAd;AACAiB,IAAAA,OAAO,CAACG,GAAR,GAAY,0CAAZ,CAHc,CAId;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAKP,IAAL,CAAUC,MAAV,GAAkB,IAAlB;AACH,GAnNI;AAoNLO,EAAAA,gBApNK,8BAoNe;AAChB,SAAKR,IAAL,CAAUC,MAAV,GAAkB,KAAlB;AACH,GAtNI;AAuNLQ,EAAAA,cAvNK,4BAuNa;AACd;AACA,QAAIL,OAAO,GAAGtB,EAAE,CAACuB,IAAH,CAAQ,yDAAR,EAAmEC,YAAnE,CAAgFxB,EAAE,CAACK,OAAnF,CAAd,CAFc,CAGd;;AACAiB,IAAAA,OAAO,CAACG,GAAR,GAAc,0CAAd,CAJc,CAKd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAKP,IAAL,CAAUC,MAAV,GAAkB,IAAlB;AACH,GAvOI;AAwOLS,EAAAA,gBAxOK,8BAwOe;AAChB,SAAKV,IAAL,CAAUC,MAAV,GAAkB,KAAlB;AACH;AA1OI,CAAT","sourceRoot":"/","sourcesContent":["var HttpHelper = require(\"../http\"); \r\nvar httpRequest = new HttpHelper();\r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        // register_alert: cc.Label,\r\n        // register_login_name: cc.EditBox,\r\n        // register_login_password: cc.EditBox,\r\n        register_knows_webview:cc.WebView\r\n    },\r\n \r\n    onLoad: function () {\r\n        // var loginname =cc.sys.localStorage.getItem('loginname');\r\n        // var password =cc.sys.localStorage.getItem('password');\r\n        // // console.log(loginname)\r\n        // if(loginname){\r\n        //    this.register_login_name.getComponent(cc.EditBox).string=loginname;\r\n        // }\r\n        // if(loginname){\r\n        //     this.register_login_password.getComponent(cc.EditBox).string=password;\r\n        // }\r\n        // // 操作文本--读取用户信息\r\n        // this.tokenlogin(); // 快捷登录\r\n        // // 账号密码登录\r\n        // this.login();\r\n        //储存缓存\r\n        // cc.sys.localStorage.setItem('token', value);\r\n        // cc.sys.localStorage.getItem(key);\r\n        // cc.sys.localStorage.removeItem(key);\r\n\r\n        // 保存最高分到本地\r\n        // const KEY_BEST_SCORE = \"bestScore\";\r\n        // let bestScore = cc.sys.localStorage.getItem(KEY_BEST_SCORE);\r\n        // if (bestScore === \"null\" || this.score > bestScore) {\r\n        //     bestScore = this.score;\r\n        // }\r\n        // cc.sys.localStorage.setItem(KEY_BEST_SCORE, bestScore);\r\n \r\n    },\r\n    tokenlogin: function(){\r\n        // 获取本地json  信息\r\n        // cc.loader.load( cc.url.raw(\"resources/login.json\"),function(err,res){  \r\n        // cc.loader.loadRes('login.json',function(err,res){   //默认resources\r\n        //     let json = res.json;\r\n        //     var params = {\r\n        //         'token': json.token,\r\n        //     };\r\n        //     cc.log(json.token); \r\n        //     var res = httpRequest.httpPost('/app/api-server/token-login', params ,function (data) {\r\n        //         cc.loader.release('resources/login.json'); //释放json 资源\r\n        //         // if(cc.sys.isNative){  //  jsb.fileUtils不支持 web  读写\r\n        //         //     jsb.fileUtils.writeStringToFile(data,token)\r\n        //         // }\r\n        //         // cc.log(data); \r\n        //         // 未登录弹出登录\r\n        //         if(data.code==0){\r\n        //             // this.loginbox.node.active = false;  // 进度隐藏\r\n\r\n                    \r\n        //         }\r\n             \r\n        //     });\r\n        // })\r\n        var token =cc.sys.localStorage.getItem('token');\r\n        if(token){\r\n                httpRequest.httpPostLogin('/app/api-server/token-login', {'token':token} ,function (data) {\r\n                    var _this =this;\r\n                    // cc.loader.release('resources/login.json'); //释放json 资源\r\n                    // if(cc.sys.isNative){  //  jsb.fileUtils不支持 web  读写\r\n                    //     jsb.fileUtils.writeStringToFile(data,token)\r\n                    // }\r\n                    // cc.log(data); \r\n                    // 未登录弹出登录\r\n                    if(data.code==0){\r\n                        // this.loginbox.node.active = false;  // 进度隐藏\r\n                    }else{\r\n                         // this.loginbox.node.active = false;  // 进度隐藏\r\n                    }\r\n            });\r\n\r\n        } \r\n    },\r\n\r\n    // login: function(){\r\n    \r\n    //    var loginname = this.register_login_name.getComponent(cc.EditBox).string;\r\n    //    var password = this.register_login_password.getComponent(cc.EditBox).string;\r\n    //     var params = {\r\n    //         'loginname': loginname,\r\n    //         'password': password,\r\n    //         // 'loginname': 'yincan1993',\r\n    //         // 'password': 123456,\r\n    //     };\r\n\r\n    //     var _this= this;\r\n    //     httpRequest.httpPost('/app/api-server/login', params ,function (data) {\r\n    //         cc.log(data); \r\n    //         if(data.code==1){\r\n    //             // _this.register_alert.color =  new cc.color('#BDFF00');\r\n    //             _this.register_alert.string ='';\r\n    //             cc.sys.localStorage.setItem('token', data.data.token);\r\n    //             cc.sys.localStorage.setItem('loginname', loginname);\r\n    //             cc.sys.localStorage.setItem('password', password);\r\n    //             _this.node.active =false;\r\n    //         }else{\r\n    //             _this.register_alert.string ='账号密码错误!';\r\n    //         }\r\n    //         //操作文本--修改用户信息\r\n    //     });\r\n\r\n    // },\r\n    //\r\n    // btnClick1: function (event, customEventData) {\r\n    //     // // 请求登录接口\r\n    //     // var params = {\r\n    //     //         'loginname': 'yincan1993',\r\n    //     //         'password': 123456,\r\n    //     //         'serverid': 1,\r\n    //     // };\r\n    //     // cc.sys.localStorage.setItem('params', JSON.stringify(params));\r\n    //     var params = JSON.parse(cc.sys.localStorage.getItem(\"params\"));\r\n    //     var token =cc.sys.localStorage.getItem('token');\r\n    \r\n    //     // cc.log(value); \r\n    //     // let httpRequest =  new HttpHelper();  \r\n    //     httpRequest.httpPost('/app/api-server/user-login', {'token':token} ,function (data) {\r\n    //         cc.log(data); \r\n    //         if(data.code==0){ // 登录失败，或本地数据失效\r\n    //             // 弹窗\r\n    //         }else{\r\n    //             // 设置服务器\r\n    //             cc.sys.localStorage.setItem('server', JSON.stringify(data.data.server));\r\n    //             if(data.code==1){// 登录成功，进入游戏\r\n    //                 // cc.log(data.data.userinfo); \r\n    //                 cc.sys.localStorage.setItem('userinfo', JSON.stringify(data.data.userinfo)); \r\n    //                 cc.director.loadScene('home/dating');\r\n    //                 // cc.sys.localStorage.setItem('userinfo', JSON.stringify(data.data.userinfo));\r\n    //                 // cc.sys.localStorage.getItem(key); //读取数据\r\n    //             }\r\n    //             if(data.code==2){ // 登录成功，未定义角色\r\n    //                 // 进入定义角色界面     \r\n    //                 var server = JSON.parse(cc.sys.localStorage.getItem('server'));\r\n    //                 // cc.log(server); \r\n    //                 // 创建角色\r\n    //                 cc.director.loadScene('register');\r\n    //             }\r\n    //         }\r\n\r\n    //     });\r\n        \r\n    //     //这里 event 是一个 Touch Event 对象，你可以通过 event.target 取到事件的发送节点\r\n    //     // var node = event.target;\r\n    //     // var button = node.getComponent(cc.Button);\r\n    //     //这里的 customEventData 参数就等于你之前设置的 \"click1 user data\"\r\n    //     // cc.log(\"node=\", node.name, \" event=\", event.type, \" data=\", customEventData);\r\n    // },\r\n\r\n    // callback: function (event) {\r\n    //     // cc.log(data)\r\n    //     // var userCount =  cc.find(\"Canvas/ground/editbox_count\").getComponent(cc.EditBox).string;\r\n    //     // var userPassward =  cc.find(\"Canvas/ground/editbox_passward\").getComponent(cc.EditBox).string;\r\n    //     // console.log(\"用户账号：\"+userCount+ \"用户密码：\"+ userPassward);\r\n    //     // HttpHelp.login(userCount,userPassward,function(isSuccess,Data){\r\n    //     //     var info = Data;\r\n    //     //     if(true == isSuccess){\r\n    //     //         console.log(\"login  success!!!\");\r\n    //     //         console.log(info);\r\n    //     //         globaluserinfo.username = info.username;\r\n    //     //         globaluserinfo.gamepoint = info.gamepoint;\r\n    //     //         globaluserinfo.skey = info.skey;\r\n    //     //         globaluserinfo.userid = info.userid;\r\n \r\n    //     //         globaluserinfo.money = info.money;\r\n    //     //         globaluserinfo.userid = info.userid;\r\n    //     //         globaluserinfo.password = info.password;\r\n    //     //         globaluserinfo.salt = info.salt;\r\n \r\n    //     //         //登录成功后加载地图资源\r\n    //             cc.director.loadScene('map');\r\n    //     //     }else{\r\n    //     //         console.log(\"login  filed!!!\")\r\n    //     //     }\r\n    //     // });\r\n    // },\r\n \r\n    start () {\r\n \r\n    },\r\n \r\n    // update (dt) {},\r\n\r\n    show_dlg () {\r\n        this.node.active =true;\r\n    },\r\n    hidden_dlg () {\r\n        this.node.active =false;\r\n    },\r\n\r\n    xieyi_show_dlg () {\r\n        // 假设你的 webview 组件的名称是 'webview'\r\n        var webview = cc.find(\"Canvas/register_konws_scorllview/register_knows_webview\").getComponent(cc.WebView);   \r\n        webview.url=\"https://www.aheart.cn/app/api-user/xieyi\"\r\n        // var  _self =this;\r\n        // var remoteUrl = httpRequest.httpUrl(\"/app/api-user/xieyi\");\r\n        // cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n        //     //     console.log(_self)\r\n        //         // _self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame; \r\n        //     _self.register_knows_webview.url = new cc.SpriteFrame(texture);\r\n        // });\r\n        // this.register_knows_webview.url ='/app/api-user/xieyi';\r\n        // this.register_knows_webview.loadUrl('/app/api-user/xieyi');\r\n        this.node.active =true;\r\n    },\r\n    xieyi_hidden_dlg () {\r\n        this.node.active =false;\r\n    },\r\n    yinsi_show_dlg () {\r\n        // 假设你的 webview 组件的名称是 'webview'\r\n        var webview = cc.find(\"Canvas/register_konws_scorllview/register_knows_webview\").getComponent(cc.WebView);       \r\n        // 设置你想要加载的 URL\r\n        webview.url = 'https://www.aheart.cn/app/api-user/yinsi';\r\n        // var tips  =cc.find(\"Canvas/tips/gonggao_tips_scorllview/view/gonggao_tips\");\r\n        // var  _self =this;\r\n        // var remoteUrl = httpRequest.httpUrl(\"/app/api-user/yinsi\");\r\n        // cc.loader.load({ url: remoteUrl }, function (err, texture) {  \r\n        //     //     console.log(_self)\r\n        //         // _self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame; \r\n        //     _self.register_knows_webview.url = new cc.SpriteFrame(texture);\r\n        // });\r\n        // this.register_knows_webview.url ='/app/api-user/yinsi';\r\n        // this.register_knows_webview.loadUrl('/app/api-user/yinsi');\r\n        this.node.active =true;\r\n    },\r\n    yinsi_hidden_dlg () {\r\n        this.node.active =false;\r\n    }\r\n\r\n});\r\n"]}
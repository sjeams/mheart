{"version":3,"sources":["assets\\Script\\背包\\bag_物品Tools.js"],"names":["cc","Class","Component","properties","biology_detail_alert","goodsid","gooduse_type","button_name","info","http_globalData","bag","log","_this","TipBoxPrefab","instantiate","http_globalAsset","model_zhuangbei_bag","getChildByName","getComponent","Label","string","gooduse","name","biology_detail_list","bind_button","TipBoxPrefab_model","addChild","TOOLS","num_height","prop","TipBoxPrefab_icon","model_zhuangbei_bag_icon","Sprite","spriteFrame","http_base_asset_zhuangbei","point","bind_button_detail","is_bag","active","find","scorllheight","parent","line_hight","Math","ceil","cellHeight","height","setContentSize","bind_button_page","on","new_page","parseInt","page","page_size","scorll_page","y","total_page","removeAllChildren","biology_detail_alert_goods","id","TipBoxPrefab_biology_detail"],"mappings":"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","sourceRoot":"/","sourcesContent":["// require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n     //技能图片渲染       // gooduse_type  1武器\r\n     biology_detail_alert(goodsid,gooduse_type,button_name){\r\n        //加载背包 和  背包列表\r\n\r\n        // http_globalData.gooduse   //物品类型\r\n        let info = http_globalData.bag //物品列表\r\n        http_globalData.goodsid = goodsid //操作的物品id\r\n        http_globalData.gooduse_type = gooduse_type // 物品类型 1\r\n        http_globalData.button_name = button_name //按钮 按钮1\r\n\r\n        // let gooduse_type_name = http_globalData.gooduse;\r\n        // http_globalData.goodsid = goodsid //操作的物品id\r\n\r\n        cc.log(http_globalData.goodsid)\r\n        // cc.log(http_globalData.gooduse_type)\r\n        // cc.log(http_globalData.button_name)\r\n        // cc.log(http_globalData.bag)\r\n        // //查看详情--弹出一次已装备详情\r\n        var _this=this;\r\n        // cc.loader.loadRes('/model背包/背包装备', function(errorMessage,loadedResource_icon){\r\n            //检查资源加载\r\n            // if( errorMessage ) { cc.log( '载入预制资源失败, 原因:' + errorMessage ); return; }\r\n            // if( !(loadedResource_icon instanceof cc.Prefab ) ) { cc.log( '你载入的不是预制资源!' ); return; }\r\n            //开始实例化预制资源\r\n            let   TipBoxPrefab =  cc.instantiate(http_globalAsset.model_zhuangbei_bag);\r\n            //技能等级\r\n            // TipBoxPrefab.getChildByName('生物数量s').getComponent(cc.Label).string='生物('+info_list.length+'/60)'\r\n            // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n            //修改背包标题-----弹窗的标题修改\r\n            TipBoxPrefab.getChildByName('标题s').getComponent(cc.Label).string= http_globalData.gooduse[gooduse_type].name\r\n\r\n\r\n            // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n            _this.biology_detail_list(TipBoxPrefab) \r\n               // 此处进行事件绑定\r\n            _this.bind_button(TipBoxPrefab,info)\r\n            //写入icon\r\n            http_globalAsset.TipBoxPrefab_model.getChildByName('左边弹窗').addChild(TipBoxPrefab);\r\n            // return http_globalAsset.TipBoxPrefab_model\r\n        // })\r\n        // return http_globalAsset.TipBoxPrefab_model\r\n    },\r\n    //list渲染\r\n    biology_detail_list(TipBoxPrefab){\r\n        //获取点击物品的类型\r\n        var _this =this;\r\n        var TOOLS =[];\r\n        var TOOLS = http_globalData.bag\r\n \r\n        //加载预制资源 PrefabUrl为 预制资源在 资源中的路径\r\n        // cc.loader.loadRes('/model背包/图标背包装备', function(errorMessage,loadedResource_icon){\r\n            var num_height=0;\r\n            for ( var prop in TOOLS) {\r\n                let info = TOOLS[prop];\r\n                //1是武器\r\n                if(info.gooduse==http_globalData.gooduse_type){\r\n                    var num_height =num_height+1\r\n                    // //开始实例化预制资源\r\n                    let   TipBoxPrefab_icon =  cc.instantiate(http_globalAsset.model_zhuangbei_bag_icon);\r\n                    // //载入技能图片\r\n                    TipBoxPrefab_icon.getChildByName('P技能').getComponent(cc.Sprite).spriteFrame =   http_globalAsset.http_base_asset_zhuangbei[info.point]\r\n                    // //技能等级\r\n                    TipBoxPrefab_icon.getChildByName('技能s').getComponent(cc.Label).string=info.name        \r\n                    // // 由于加载资源的操作是异步的，如果在加载完成前就绑定了事件，有可能会触发事件的自动执行。\r\n                    //重新挂载\r\n                    _this.bind_button_detail(TipBoxPrefab_icon,info)\r\n                    //隐藏已经使用的装备\r\n                    if(info.is_bag==1){\r\n                        TipBoxPrefab_icon.active=false\r\n                    }\r\n                    //写入icon\r\n                    cc.find(\"列表/content/gridLayout\",TipBoxPrefab).addChild(TipBoxPrefab_icon);\r\n                }\r\n            }\r\n            // 定义content滚动条高度\r\n            let scorllheight =  cc.find(\"列表/content/gridLayout\",TipBoxPrefab).parent;\r\n            //滚动高度= 预制体100*个数+ 上下 预留10 的位置  \r\n            //列个数--进1取整\r\n            let line_hight =Math.ceil(num_height/3)\r\n            let cellHeight =  cc.find(\"列表/content/gridLayout\",TipBoxPrefab).height * 0.25+10;\r\n            let  height =  cellHeight*(line_hight )\r\n            if(height<=420){  let height = 420 }\r\n            //设置滚动条高度\r\n            scorllheight.setContentSize(500,height)\r\n\r\n            TipBoxPrefab.getChildByName('总数s').getComponent(cc.Label).string =Math.ceil(num_height/12)\r\n            // 此处进行事件绑定\r\n            _this.bind_button_page(TipBoxPrefab)\r\n        // })\r\n        // return TipBoxPrefab\r\n    },\r\n    //分页\r\n    bind_button_page(TipBoxPrefab){\r\n        TipBoxPrefab.getChildByName('上一页').on('click', function () {\r\n           var new_page = TipBoxPrefab.getChildByName('页码s').getComponent(cc.Label).string\r\n           var new_page = parseInt(new_page)\r\n            if(new_page>1){\r\n                new_page= parseInt(new_page-1)\r\n                TipBoxPrefab.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n            //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           let cellHeight =  cc.find(\"列表/content/gridLayout\",TipBoxPrefab).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n   \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab.getComponent(cc.ScrollView)\r\n           cc.find(\"列表/content/gridLayout\",TipBoxPrefab).parent.y = scorll_page; // 水平居中\r\n        }, this);\r\n        TipBoxPrefab.getChildByName('下一页').on('click', function () {\r\n            var total_page = TipBoxPrefab.getChildByName('总数s').getComponent(cc.Label).string\r\n            var total_page = parseInt(total_page)\r\n            var new_page = TipBoxPrefab.getChildByName('页码s').getComponent(cc.Label).string\r\n            var new_page = parseInt(new_page)\r\n            if(new_page<total_page){\r\n                new_page= parseInt(new_page+1)\r\n                TipBoxPrefab.getChildByName('页码s').getComponent(cc.Label).string =new_page\r\n            }\r\n           //12个一页/3   = 每页的列数4列\r\n           var page = new_page\r\n           var page_size =12/3\r\n           let cellHeight =  cc.find(\"列表/content/gridLayout\",TipBoxPrefab).height * 0.25+10;\r\n           var scorll_page = (cellHeight*page_size*(page-1))+210;\r\n         \r\n           // 获取ScrollBar组件\r\n        //    var scrollView = TipBoxPrefab.getComponent(cc.ScrollView)\r\n           cc.find(\"列表/content/gridLayout\",TipBoxPrefab).parent.y = scorll_page; // 水平居中\r\n        }, this);\r\n\r\n    },\r\n    //绑定点击事件--关闭遮罩\r\n    bind_button(TipBoxPrefab_icon){\r\n        TipBoxPrefab_icon.getChildByName('遮罩').on('click', function () {\r\n            // 事件处理逻辑\r\n            //移除挂载\r\n            http_globalAsset.TipBoxPrefab_model.getChildByName('左边弹窗').removeAllChildren();\r\n\r\n        }, this);\r\n\r\n    },\r\n    //绑定点击事件--alert详情\r\n    bind_button_detail(TipBoxPrefab_icon,info){\r\n        //点击 弹窗详情\r\n        TipBoxPrefab_icon.on('click', function () {\r\n            //点击选中的物品\r\n            http_globalAsset.TipBoxPrefab_model.getComponent('bag_详情Tools').biology_detail_alert_goods(TipBoxPrefab_icon,info)\r\n        }, this);\r\n        // 弹窗详情 //查看详情--弹出一次已装备详情--如果点击带id，并且相等，弹窗窗口 -- \r\n        if(http_globalData.goodsid==info.id){\r\n            //当前弹出的预制节点\r\n            http_globalData.TipBoxPrefab_biology_detail = TipBoxPrefab_icon;\r\n            // cc.log(goodsid)\r\n            http_globalAsset.TipBoxPrefab_model.getComponent('bag_详情Tools').biology_detail_alert_goods(TipBoxPrefab_icon,info)\r\n        }\r\n    },\r\n\r\n\r\n});\r\n"]}
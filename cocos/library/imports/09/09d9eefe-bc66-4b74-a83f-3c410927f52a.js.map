{"version":3,"sources":["assets\\Script\\场景\\home_map.js"],"names":["cc","Class","Component","properties","onLoad","http_globalData","BoxPrefab_content","find","httpRequestModel","model_back_button","httpRequestBagApi","http_music","http_user_word_index","model_fighting_map","spawnTools","addWordMap","reloadWord","data","getComponent","Label","string","name","time","type_name","info","user_in_word_map","BoxPrefab","biology_detail_list","addTouchEvent","node_1","on","Node","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","http_user_word_new","TipBoxPrefab_model","info_list","Promise","resolve","TOOLS","prop","TipBoxPrefab_icon","instantiate","http_globalAsset","map","biology_list","total","length","map_status","x","httpRequest","number_map_rand","y","getChildByName","Sprite","spriteFrame","http_base_asset_biology","picture","color","type_color","star","i","onConfirBtn","map_int","addChild","sys","localStorage","setItem","JSON","stringify","playGame"],"mappings":"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","sourceRoot":"/","sourcesContent":["// require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {  \r\n    },\r\n    async onLoad() {\r\n      //全局定义容器节点\r\n      http_globalData.BoxPrefab_content= cc.find('Canvas/大厅/content')\r\n      await httpRequestModel.model_back_button('sence_zhutian')//返回按钮\r\n      await httpRequestBagApi.http_music()\r\n      await httpRequestBagApi.http_user_word_index()\r\n      await httpRequestModel.model_fighting_map();  // 引入 战斗模型model\r\n      await this.spawnTools()\r\n    },\r\n    async spawnTools () {\r\n        if(http_globalData.http_user_word_index){\r\n        //生成世界\r\n       await  this.addWordMap(http_globalData.http_user_word_index) //生成生物\r\n        }else{\r\n            //刷新地图\r\n        await this.reloadWord()//刷新世界地图\r\n        }\r\n    },\r\n    //生成生物\r\n    async addWordMap(data){\r\n        // cc.log(data)\r\n        cc.find('Canvas/当前世界').getComponent(cc.Label).string = data.name+'('+data.time+'年)' \r\n        cc.find('Canvas/流速').getComponent(cc.Label).string = '流速: '+data.time+'年/S' \r\n        cc.find('Canvas/类型').getComponent(cc.Label).string = '类型: '+data.type_name\r\n        let info =data.user_in_word_map;\r\n        //技能图标挂载\r\n        var BoxPrefab =http_globalData.BoxPrefab_content\r\n        await  this.biology_detail_list(BoxPrefab,info)\r\n        // await BoxPrefab.getComponent('home_map_detail').biology_detail_list(BoxPrefab,info)\r\n    },\r\n    addTouchEvent(node_1) {\r\n        node_1.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        node_1.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    },\r\n    async reloadWord(){\r\n        var data= await httpRequestBagApi.http_user_word_new()\r\n        //写入地图数据\r\n        await this.addWordMap(data.data)\r\n\r\n    },\r\n    //技能图片渲染\r\n    async biology_detail_list(TipBoxPrefab_model,info_list){\r\n        return new Promise(resolve => {\r\n        var TOOLS =[];\r\n        var TOOLS = info_list;\r\n        //开始实例化预制资源\r\n        for (var prop in info_list) {\r\n            //声明节点对象\r\n            let  TipBoxPrefab_icon =  cc.instantiate(http_globalAsset.model_fighting_map);\r\n            let map = TOOLS[prop];\r\n            let info = map.biology_list[0];\r\n            let total = map.biology_list.length;\r\n            //战斗胜利移除\r\n            if(map.map_status==1){\r\n                //设置距离\r\n                TipBoxPrefab_icon.x=httpRequest.number_map_rand(map.x,100) //设置随x机偏移量0-49\r\n                TipBoxPrefab_icon.y=httpRequest.number_map_rand(map.y,10)//设置随机y偏移量0-49\r\n                //放在资源下面\r\n                // let image = info.picture;\r\n                TipBoxPrefab_icon.getChildByName('生物').getComponent(cc.Sprite).spriteFrame =   http_globalAsset.http_base_asset_biology[info.picture]\r\n                var color = ['#FFFFFF','green','#BDFF00','#FFD100','#FF0000','#ffe000',];\r\n                var type_color = color[info['yiXing']];\r\n                // console.log(info)\r\n                var star ='';    \r\n                for(var i=0;i<=info['yiXing'];i++){\r\n                    star +='⭐';\r\n                }\r\n                TipBoxPrefab_icon.getChildByName('名称').getComponent(cc.Label).string=info['name']+'('+total+')';\r\n                TipBoxPrefab_icon.getChildByName('名称').color = new cc.color(type_color);\r\n                TipBoxPrefab_icon.getChildByName('等级').getComponent(cc.Label).string='Lv.'+info['grade']+'('+info['state_name']['name']+')';\r\n                TipBoxPrefab_icon.getChildByName('等级').color = new cc.color(type_color);\r\n                TipBoxPrefab_icon.getChildByName('星级').getComponent(cc.Label).string= star;\r\n                //创建一个新button 并将其挂载到创建的精灵下\r\n                this.onConfirBtn(TipBoxPrefab_icon,map.map_int);\r\n                //写入icon\r\n                TipBoxPrefab_model.addChild(TipBoxPrefab_icon);\r\n            }\r\n        }\r\n        resolve();\r\n    })\r\n        // return TipBoxPrefab_model\r\n    },\r\n    //按钮点击回调\r\n    onConfirBtn:function(TipBoxPrefab_icon,map_int){\r\n        TipBoxPrefab_icon.on('click', function () {\r\n            //session设置战斗请求id\r\n            cc.sys.localStorage.setItem('figthing_map_int', JSON.stringify(map_int)); \r\n            // cc.log(333)\r\n            httpRequest.playGame(\"sence_zhandou\",1,1)\r\n        })\r\n    },\r\n});\r\n"]}
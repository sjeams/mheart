{"version":3,"sources":["assets\\Script\\Hls\\Sprite_HSL.js"],"names":["_vert","require","_frag","SpriteHSL","cc","Class","Component","properties","dH","type","Integer","range","slide","dS","dL","previewId","editorOnly","visible","_program","onLoad","render","editor","requireComponent","Sprite","executeInEditMode","onFocusInEditor","clearInterval","self","setInterval","onLostFocusInEditor","onDestroy","h","s","l","enforce","GLProgram","sys","isNative","initWithString","link","updateUniforms","glProgram_state","GLProgramState","getOrCreateWithGLProgram","setUniformFloat","initWithVertexShaderByteArray","addAttribute","macro","ATTRIBUTE_NAME_POSITION","VERTEX_ATTRIB_POSITION","ATTRIBUTE_NAME_COLOR","VERTEX_ATTRIB_COLOR","ATTRIBUTE_NAME_TEX_COORD","VERTEX_ATTRIB_TEX_COORDS","setUniformLocationWith1f","getUniformLocationForName","setProgram","node","_sgNode","program","setGLProgramState","setShaderProgram","children","i","length"],"mappings":"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","sourceRoot":"/","sourcesContent":["var _vert = require(\"./HSL_Vert\");\nvar _frag = require(\"./HSL_Frag\");\n\nvar SpriteHSL = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        dH: {\n            default: 0,\n            type: cc.Integer,\n            range: [0, 360, 1],\n            slide: true\n        },\n        dS: {\n            default: 0,\n            type: cc.Integer,\n            range: [-1, 1, 0.01],\n            slide: true\n        },\n        dL: {\n            default: 0,\n            type: cc.Integer,\n            range: [-1, 1, 0.01],\n            slide: true\n        },\n        // affectChildren: {\n        //     default: true,\n        //     notify: function () {\n\n        //     }\n        // },\n        previewId: {\n            default: null,\n            editorOnly: true,\n            visible: false\n        },\n        _program: {\n            default: null,\n            visible: false\n        }\n    },\n\n    onLoad: function () {\n        this.render(this.dH,this.dS,this.dL,false);\n    },\n\n    editor: {\n        requireComponent: cc.Sprite,\n        executeInEditMode: true\n    },\n\n    onFocusInEditor: function () {\n        if (this.previewId != null)\n            clearInterval(this.previewId);\n        var self = this;\n        this.previewId = setInterval(function () {\n            self.render(self.dH,self.dS,self.dL,false);\n        }, 1 / 60);\n    },\n\n    onLostFocusInEditor: function () {\n        if (this.previewId != null)\n            clearInterval(this.previewId);\n    },\n\n    onDestroy: function () {\n        if (this.previewId != null)\n            clearInterval(this.previewId);\n        this.dH = this.dL = this.dS = 0;\n        this.render(this.dH,this.dS,this.dL,false);\n    },\n\n    render: function (h,s,l,enforce) {\n        if (!this._program)\n            this._program = new cc.GLProgram();\n        if (cc.sys.isNative) {\n            this._program.initWithString(_vert, _frag);\n            this._program.link();\n            this._program.updateUniforms();\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);\n            glProgram_state.setUniformFloat(\"u_dH\", h);\n            glProgram_state.setUniformFloat(\"u_dS\", s);\n            glProgram_state.setUniformFloat(\"u_dL\", l);\n        } else {\n            this._program.initWithVertexShaderByteArray(_vert, _frag);\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);\n            this._program.link();\n            this._program.updateUniforms();\n            this._program.setUniformLocationWith1f(this._program.getUniformLocationForName(\"u_dH\"), h);\n            this._program.setUniformLocationWith1f(this._program.getUniformLocationForName(\"u_dS\"), s);\n            this._program.setUniformLocationWith1f(this._program.getUniformLocationForName(\"u_dL\"), l);\n        }\n        this.setProgram(this.node._sgNode, this._program, enforce);\n    },\n\n    setProgram: function (node, program, enforce) {\n\n        if (cc.sys.isNative) {\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(program);\n            node.setGLProgramState(glProgram_state);\n        } else {\n            node.setShaderProgram(program);\n        }\n\n        var children = node.children;\n        if (!children)\n            return;\n        for (var i = 0; i < children.length; i++) {\n            this.setProgram(children[i], program);\n        }\n    }\n});"]}
{"version":3,"sources":["assets\\Script\\登录\\login_in.js"],"names":["require","cc","Class","Component","properties","register_alert","Label","register_login_name","EditBox","register_login_password","onLoad","loginname","sys","localStorage","getItem","password","getComponent","string","login","params","_this","httpRequest","httpPostLogin","data","code","setItem","token","node","active","find","userinfo","phone","slice","start","show_dlg","hidden_dlg"],"mappings":"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","sourceRoot":"/","sourcesContent":["require(\"../common\"); \r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        register_alert: cc.Label,\r\n        register_login_name: cc.EditBox,\r\n        register_login_password: cc.EditBox\r\n    },\r\n \r\n    onLoad: function () {\r\n        var loginname =cc.sys.localStorage.getItem('loginname');\r\n        var password =cc.sys.localStorage.getItem('password');\r\n        // console.log(loginname)\r\n        if(loginname){\r\n           this.register_login_name.getComponent(cc.EditBox).string=loginname;\r\n        }\r\n        if(loginname){\r\n            this.register_login_password.getComponent(cc.EditBox).string=password;\r\n        }\r\n        // 操作文本--读取用户信息\r\n        // this.tokenlogin(); // 快捷登录\r\n        // // 账号密码登录\r\n        // this.login();\r\n        //储存缓存\r\n        // cc.sys.localStorage.setItem('token', value);\r\n        // cc.sys.localStorage.getItem(key);\r\n        // cc.sys.localStorage.removeItem(key);\r\n\r\n        // 保存最高分到本地\r\n        // const KEY_BEST_SCORE = \"bestScore\";\r\n        // let bestScore = cc.sys.localStorage.getItem(KEY_BEST_SCORE);\r\n        // if (bestScore === \"null\" || this.score > bestScore) {\r\n        //     bestScore = this.score;\r\n        // }\r\n        // cc.sys.localStorage.setItem(KEY_BEST_SCORE, bestScore);\r\n    },\r\n    // tokenlogin: function(){\r\n    //     var token =cc.sys.localStorage.getItem('token');\r\n    //     //定位弹出窗口\r\n    //     cc.find(\"Canvas/server/user_status\").active=true;\r\n    //     var user_phone  =cc.find(\"Canvas/server/user_status/user_phone\");\r\n    //     if(token){\r\n    //             httpRequest.httpPostLogin('/app/api-server/token-login', {'token':token} ,function (data) {\r\n    //                 // var _this =this;\r\n    //                 // cc.loader.release('resources/login.json'); //释放json 资源\r\n    //                 // if(cc.sys.isNative){  //  jsb.fileUtils不支持 web  读写\r\n    //                 //     jsb.fileUtils.writeStringToFile(data,token)\r\n    //                 // }\r\n    //                 // cc.log(data); \r\n    //                 // 未登录弹出登录\r\n    //                // 登录成功\r\n    //                 if(data.code==1){\r\n    //                     // 其中slice(start, end)：用于提取字符串的片段\r\n    //                     // str.slice(1) 指下标为1之后的所有元素\r\n    //                     var loginname =  data.data.userinfo.loginname;\r\n    //                     var phone = loginname.slice(0,3) + \"****\" + loginname.slice(7,10);\r\n    //                     user_phone.getComponent(cc.Label).string=phone;\r\n    //                     // this.loginbox.node.active = false;  // 进度隐藏\r\n    //                 }else{\r\n    //                     user_phone.getComponent(cc.Label).string=data.message;\r\n    //                     // this.loginbox.node.active = false;  // 进度隐藏\r\n    //                 }\r\n    //         });\r\n\r\n    //     }else{\r\n    //         user_phone.getComponent(cc.Label).string=\"未登录\";\r\n    //     }\r\n    // },\r\n\r\n    login: function(){\r\n       var loginname = this.register_login_name.getComponent(cc.EditBox).string;\r\n       var password = this.register_login_password.getComponent(cc.EditBox).string;\r\n        var params = {\r\n            'loginname': loginname,\r\n            'password': password,\r\n            // 'loginname': 'yincan1993',\r\n            // 'password': 123456,\r\n        };\r\n        var _this= this;\r\n        httpRequest.httpPostLogin('/app/api-server/login', params ,function (data) {\r\n            // cc.log(data); \r\n            if(data.code==1){\r\n                // _this.register_alert.color =  new cc.color('#BDFF00');\r\n                _this.register_alert.string ='';\r\n                cc.sys.localStorage.setItem('token', data.data.token);\r\n                cc.sys.localStorage.setItem('loginname', loginname);\r\n                cc.sys.localStorage.setItem('password', password);\r\n                _this.node.active =false;\r\n                // cc.find(\"Canvas/server/user_status/user_phone\");\r\n                cc.find(\"Canvas/server/user_status\").active=true;\r\n                var loginname =  data.data.userinfo.loginname;\r\n                var phone = loginname.slice(0,3) + \"****\" + loginname.slice(7,10);\r\n                cc.find(\"Canvas/server/user_status/user_phone\").getComponent(cc.Label).string=phone;\r\n                    // _this.tokenlogin()\r\n                // var mycomponet =  _this.node.getComponent(register)\r\n                // mycomponet.tokenlogin(); // 快捷登录\r\n            }else{\r\n                _this.register_alert.string ='账号密码错误!';\r\n            }\r\n            //操作文本--修改用户信息\r\n        });\r\n\r\n    },\r\n    start () {\r\n \r\n    },\r\n \r\n    // update (dt) {},\r\n\r\n    show_dlg () {\r\n        this.node.active =true;\r\n    },\r\n    hidden_dlg () {\r\n        this.node.active =false;\r\n    }\r\n});\r\n"]}